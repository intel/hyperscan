<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>API Reference: Files &mdash; Hyperscan 4.1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/hyperscan.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '4.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="copyright" title="Copyright" href="copyright.html" />
    <link rel="top" title="Hyperscan 4.1.0 documentation" href="index.html" />
    <link rel="prev" title="API Reference: Constants" href="api_constants.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head>
  <body role="document">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="api-reference-files">
<span id="api-files"></span><h1>API Reference: Files<a class="headerlink" href="#api-reference-files" title="Permalink to this headline">¶</a></h1>
<div class="section" id="file-hs-h">
<h2>File: hs.h<a class="headerlink" href="#file-hs-h" title="Permalink to this headline">¶</a></h2>
<p>The complete Hyperscan API definition. </p>
<p>Hyperscan is a high speed regular expression engine.</p>
<p>This header includes both the Hyperscan compiler and runtime components. See the individual component headers for documentation. </p>
</div>
<div class="section" id="file-hs-common-h">
<h2>File: hs_common.h<a class="headerlink" href="#file-hs-common-h" title="Permalink to this headline">¶</a></h2>
<p>The Hyperscan common API definition. </p>
<p>Hyperscan is a high speed regular expression engine.</p>
<p>This header contains functions available to both the Hyperscan compiler and runtime. </p>
<div class="breathe-sectiondef container">
<p class="breathe-sectiondef-title rubric">Defines</p>
<dl class="define">
<dt id="c.HS_SUCCESS">
<span class="target" id="project0group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"></span><code class="descname">HS_SUCCESS</code><a class="headerlink" href="#c.HS_SUCCESS" title="Permalink to this definition">¶</a></dt>
<dd><p>The engine completed normally. </p>
</dd></dl>

<dl class="define">
<dt id="c.HS_INVALID">
<span class="target" id="project0group__HS__ERROR_1ga90b69de15d46488887c0522c2864bab9"></span><code class="descname">HS_INVALID</code><a class="headerlink" href="#c.HS_INVALID" title="Permalink to this definition">¶</a></dt>
<dd><p>A parameter passed to this function was invalid. </p>
</dd></dl>

<dl class="define">
<dt id="c.HS_NOMEM">
<span class="target" id="project0group__HS__ERROR_1ga209e23f064df891f66575950b383832c"></span><code class="descname">HS_NOMEM</code><a class="headerlink" href="#c.HS_NOMEM" title="Permalink to this definition">¶</a></dt>
<dd><p>A memory allocation failed. </p>
</dd></dl>

<dl class="define">
<dt id="c.HS_SCAN_TERMINATED">
<span class="target" id="project0group__HS__ERROR_1ga122c9eb3b263d14360532e47c647fc16"></span><code class="descname">HS_SCAN_TERMINATED</code><a class="headerlink" href="#c.HS_SCAN_TERMINATED" title="Permalink to this definition">¶</a></dt>
<dd><p>The engine was terminated by callback.</p>
<p>This return value indicates that the target buffer was partially scanned, but that the callback function requested that scanning cease after a match was located. </p>
</dd></dl>

<dl class="define">
<dt id="c.HS_COMPILER_ERROR">
<span class="target" id="project0group__HS__ERROR_1gae73b85ba0cafa46768c9b61f435410ca"></span><code class="descname">HS_COMPILER_ERROR</code><a class="headerlink" href="#c.HS_COMPILER_ERROR" title="Permalink to this definition">¶</a></dt>
<dd><p>The pattern compiler failed, and the <a class="reference internal" href="#project0hs__compile_8h_1a70478dae6603bdb6c1f46d80829ada8d"><span>hs_compile_error_t</span></a> should be inspected for more detail. </p>
</dd></dl>

<dl class="define">
<dt id="c.HS_DB_VERSION_ERROR">
<span class="target" id="project0group__HS__ERROR_1ga86a4e9b45ad47bbae163888f2ef56fab"></span><code class="descname">HS_DB_VERSION_ERROR</code><a class="headerlink" href="#c.HS_DB_VERSION_ERROR" title="Permalink to this definition">¶</a></dt>
<dd><p>The given database was built for a different version of Hyperscan. </p>
</dd></dl>

<dl class="define">
<dt id="c.HS_DB_PLATFORM_ERROR">
<span class="target" id="project0group__HS__ERROR_1ga818162ba342f880040cad7350ba3f709"></span><code class="descname">HS_DB_PLATFORM_ERROR</code><a class="headerlink" href="#c.HS_DB_PLATFORM_ERROR" title="Permalink to this definition">¶</a></dt>
<dd><p>The given database was built for a different platform (i.e., CPU type). </p>
</dd></dl>

<dl class="define">
<dt id="c.HS_DB_MODE_ERROR">
<span class="target" id="project0group__HS__ERROR_1ga5473f52d0822ef95125c54a21ee6d463"></span><code class="descname">HS_DB_MODE_ERROR</code><a class="headerlink" href="#c.HS_DB_MODE_ERROR" title="Permalink to this definition">¶</a></dt>
<dd><p>The given database was built for a different mode of operation. This error is returned when streaming calls are used with a block or vectored database and vice versa. </p>
</dd></dl>

<dl class="define">
<dt id="c.HS_BAD_ALIGN">
<span class="target" id="project0group__HS__ERROR_1ga65b0cd2c66f76b4a4a64967052fd34ac"></span><code class="descname">HS_BAD_ALIGN</code><a class="headerlink" href="#c.HS_BAD_ALIGN" title="Permalink to this definition">¶</a></dt>
<dd><p>A parameter passed to this function was not correctly aligned. </p>
</dd></dl>

<dl class="define">
<dt id="c.HS_BAD_ALLOC">
<span class="target" id="project0group__HS__ERROR_1ga9fd16f0296f0444eb6d7047ecbfddf4e"></span><code class="descname">HS_BAD_ALLOC</code><a class="headerlink" href="#c.HS_BAD_ALLOC" title="Permalink to this definition">¶</a></dt>
<dd><p>The memory allocator (either malloc() or the allocator set with <a class="reference internal" href="#project0hs__common_8h_1a5ca2c6de1dac5bb462e5cf4ab14de3bb"><span>hs_set_allocator()</span></a>) did not correctly return memory suitably aligned for the largest representable data type on this platform. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef container">
<p class="breathe-sectiondef-title rubric">Typedefs</p>
<dl class="typedef">
<dt id="c.hs_database_t">
<span class="target" id="project0hs__common_8h_1aaabb7a1acc5b6a1efd377af877717b92"></span><em class="property">typedef </em><code class="descname">hs_database_t</code><a class="headerlink" href="#c.hs_database_t" title="Permalink to this definition">¶</a></dt>
<dd><p>A Hyperscan pattern database.</p>
<p>Generated by one of the Hyperscan compiler functions:<ul class="simple">
<li><a class="reference internal" href="#project0hs__compile_8h_1aeb302c749c316b296e3c3cdaa8508e73"><span>hs_compile()</span></a></li>
<li><a class="reference internal" href="#project0hs__compile_8h_1ae61b23042fd72756fb774bb87c581e84"><span>hs_compile_multi()</span></a></li>
<li><a class="reference internal" href="#project0hs__compile_8h_1aacc508bea3042f1faba32c3818bfc2a3"><span>hs_compile_ext_multi()</span></a> </li>
</ul>
</p>
</dd></dl>

<dl class="typedef">
<dt id="c.hs_error_t">
<span class="target" id="project0hs__common_8h_1abe162d33344545644ac583b4df13a09b"></span><em class="property">typedef </em><code class="descname">hs_error_t</code><a class="headerlink" href="#c.hs_error_t" title="Permalink to this definition">¶</a></dt>
<dd><p>A type for errors returned by Hyperscan functions. </p>
</dd></dl>

<dl class="typedef">
<dt id="c.hs_alloc_t">
<span class="target" id="project0hs__common_8h_1a1595e6c5a94cd4798a0a7f0d6be3ae73"></span><em class="property">typedef </em><code class="descname">(* hs_alloc_t)</code><span class="sig-paren">(</span>size_t<em>&nbsp;size</em><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_alloc_t" title="Permalink to this definition">¶</a></dt>
<dd><p>The type of the callback function that will be used by Hyperscan to allocate more memory at runtime as required, for example in <a class="reference internal" href="#project0hs__runtime_8h_1a54bc32490fdcc331d074e60169aeeda7"><span>hs_open_stream()</span></a> to allocate stream state.</p>
<p>If Hyperscan is to be used in a multi-threaded, or similarly concurrent environment, the allocation function will need to be re-entrant, or similarly safe for concurrent use.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>A pointer to the region of memory allocated, or NULL on error. </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last">
<li><code class="first docutils literal"><span class="pre">size</span></code> - <p>The number of bytes to allocate. </p>
</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="typedef">
<dt id="c.hs_free_t">
<span class="target" id="project0hs__common_8h_1aae101e29ee28c489d0f1b1c4c3e5ba2a"></span><em class="property">typedef </em><code class="descname">(* hs_free_t)</code><span class="sig-paren">(</span>void<em>&nbsp;*ptr</em><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_free_t" title="Permalink to this definition">¶</a></dt>
<dd><p>The type of the callback function that will be used by Hyperscan to free memory regions previously allocated using the <a class="reference internal" href="#project0hs__common_8h_1a1595e6c5a94cd4798a0a7f0d6be3ae73"><span>hs_alloc_t</span></a> function.</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last">
<li><code class="first docutils literal"><span class="pre">ptr</span></code> - <p>The region of memory to be freed. </p>
</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef container">
<p class="breathe-sectiondef-title rubric">Functions</p>
<dl class="function">
<dt id="c.hs_free_database">
<span class="target" id="project0hs__common_8h_1a8127f1c24ec8708d0284102d9b7bc082"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t">hs_error_t</a> <code class="descname">hs_free_database</code><span class="sig-paren">(</span><a class="reference internal" href="#c.hs_database_t" title="hs_database_t">hs_database_t</a>  *<em>&nbsp;db</em><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_free_database" title="Permalink to this definition">¶</a></dt>
<dd><p>Free a compiled pattern database.</p>
<p>The free callback set by <a class="reference internal" href="#project0hs__common_8h_1a0aaadd0fc97838f728fa220024be2509"><span>hs_set_database_allocator()</span></a> (or <a class="reference internal" href="#project0hs__common_8h_1a5ca2c6de1dac5bb462e5cf4ab14de3bb"><span>hs_set_allocator()</span></a>) will be used by this function.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd><a class="reference internal" href="#project0group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span>HS_SUCCESS</span></a> on success, other values on failure. </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last">
<li><code class="first docutils literal"><span class="pre">db</span></code> - <p>A compiled pattern database. NULL may also be safely provided, in which case the function does nothing.</p>
</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="c.hs_serialize_database">
<span class="target" id="project0hs__common_8h_1accea8a4a5481683e0564058621c9b8de"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t">hs_error_t</a> <code class="descname">hs_serialize_database</code><span class="sig-paren">(</span>const  <a class="reference internal" href="#c.hs_database_t" title="hs_database_t">hs_database_t</a>  *<em>&nbsp;db</em>, char **<em>&nbsp;bytes</em>, size_t *<em>&nbsp;length</em><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_serialize_database" title="Permalink to this definition">¶</a></dt>
<dd><p>Serialize a pattern database to a stream of bytes.</p>
<p>The allocator callback set by <a class="reference internal" href="#project0hs__common_8h_1a28571486e60e29b54d6b5fcf9ec1e0b1"><span>hs_set_misc_allocator()</span></a> (or <a class="reference internal" href="#project0hs__common_8h_1a5ca2c6de1dac5bb462e5cf4ab14de3bb"><span>hs_set_allocator()</span></a>) will be used by this function.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd><a class="reference internal" href="#project0group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span>HS_SUCCESS</span></a> on success, <a class="reference internal" href="#project0group__HS__ERROR_1ga209e23f064df891f66575950b383832c"><span>HS_NOMEM</span></a> if the byte array cannot be allocated, other values may be returned if errors are detected. </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last">
<li><code class="first docutils literal"><span class="pre">db</span></code> - <p>A compiled pattern database.</p>
</li>
<li><code class="first docutils literal"><span class="pre">bytes</span></code> - <p>On success, a pointer to an array of bytes will be returned here. These bytes can be subsequently relocated or written to disk. The caller is responsible for freeing this block.</p>
</li>
<li><code class="first docutils literal"><span class="pre">length</span></code> - <p>On success, the number of bytes in the generated byte array will be returned here.</p>
</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="c.hs_deserialize_database">
<span class="target" id="project0hs__common_8h_1a87007f735bc81c5d3b5865dbd38ec5b7"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t">hs_error_t</a> <code class="descname">hs_deserialize_database</code><span class="sig-paren">(</span>const char *<em>&nbsp;bytes</em>, const size_t<em>&nbsp;length</em>, <a class="reference internal" href="#c.hs_database_t" title="hs_database_t">hs_database_t</a>  **<em>&nbsp;db</em><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_deserialize_database" title="Permalink to this definition">¶</a></dt>
<dd><p>Reconstruct a pattern database from a stream of bytes previously generated by <a class="reference internal" href="#project0hs__common_8h_1accea8a4a5481683e0564058621c9b8de"><span>hs_serialize_database()</span></a>.</p>
<p>This function will allocate sufficient space for the database using the allocator set with <a class="reference internal" href="#project0hs__common_8h_1a0aaadd0fc97838f728fa220024be2509"><span>hs_set_database_allocator()</span></a> (or <a class="reference internal" href="#project0hs__common_8h_1a5ca2c6de1dac5bb462e5cf4ab14de3bb"><span>hs_set_allocator()</span></a>); to use a pre-allocated region of memory, use the <a class="reference internal" href="#project0hs__common_8h_1a597f29547148e5378812be9a19d7f4cd"><span>hs_deserialize_database_at()</span></a> function.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd><a class="reference internal" href="#project0group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span>HS_SUCCESS</span></a> on success, other values on failure. </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last">
<li><code class="first docutils literal"><span class="pre">bytes</span></code> - <p>A byte array generated by <a class="reference internal" href="#project0hs__common_8h_1accea8a4a5481683e0564058621c9b8de"><span>hs_serialize_database()</span></a> representing a compiled pattern database.</p>
</li>
<li><code class="first docutils literal"><span class="pre">length</span></code> - <p>The length of the byte array generated by <a class="reference internal" href="#project0hs__common_8h_1accea8a4a5481683e0564058621c9b8de"><span>hs_serialize_database()</span></a>. This should be the same value as that returned by <a class="reference internal" href="#project0hs__common_8h_1accea8a4a5481683e0564058621c9b8de"><span>hs_serialize_database()</span></a>.</p>
</li>
<li><code class="first docutils literal"><span class="pre">db</span></code> - <p>On success, a pointer to a newly allocated <a class="reference internal" href="#project0hs__common_8h_1aaabb7a1acc5b6a1efd377af877717b92"><span>hs_database_t</span></a> will be returned here. This database can then be used for scanning, and eventually freed by the caller using <a class="reference internal" href="#project0hs__common_8h_1a8127f1c24ec8708d0284102d9b7bc082"><span>hs_free_database()</span></a>.</p>
</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="c.hs_deserialize_database_at">
<span class="target" id="project0hs__common_8h_1a597f29547148e5378812be9a19d7f4cd"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t">hs_error_t</a> <code class="descname">hs_deserialize_database_at</code><span class="sig-paren">(</span>const char *<em>&nbsp;bytes</em>, const size_t<em>&nbsp;length</em>, <a class="reference internal" href="#c.hs_database_t" title="hs_database_t">hs_database_t</a>  *<em>&nbsp;db</em><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_deserialize_database_at" title="Permalink to this definition">¶</a></dt>
<dd><p>Reconstruct a pattern database from a stream of bytes previously generated by <a class="reference internal" href="#project0hs__common_8h_1accea8a4a5481683e0564058621c9b8de"><span>hs_serialize_database()</span></a> at a given memory location.</p>
<p>This function (unlike <a class="reference internal" href="#project0hs__common_8h_1a87007f735bc81c5d3b5865dbd38ec5b7"><span>hs_deserialize_database()</span></a>) will write the reconstructed database to the memory location given in the <em>db</em> parameter. The amount of space required at this location can be determined with the <a class="reference internal" href="#project0hs__common_8h_1a83006d0498780313470c84d67e9181b7"><span>hs_serialized_database_size()</span></a> function.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd><a class="reference internal" href="#project0group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span>HS_SUCCESS</span></a> on success, other values on failure. </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last">
<li><code class="first docutils literal"><span class="pre">bytes</span></code> - <p>A byte array generated by <a class="reference internal" href="#project0hs__common_8h_1accea8a4a5481683e0564058621c9b8de"><span>hs_serialize_database()</span></a> representing a compiled pattern database.</p>
</li>
<li><code class="first docutils literal"><span class="pre">length</span></code> - <p>The length of the byte array generated by <a class="reference internal" href="#project0hs__common_8h_1accea8a4a5481683e0564058621c9b8de"><span>hs_serialize_database()</span></a>. This should be the same value as that returned by <a class="reference internal" href="#project0hs__common_8h_1accea8a4a5481683e0564058621c9b8de"><span>hs_serialize_database()</span></a>.</p>
</li>
<li><code class="first docutils literal"><span class="pre">db</span></code> - <p>Pointer to an 8-byte aligned block of memory of sufficient size to hold the deserialized database. On success, the reconstructed database will be written to this location. This database can then be used for pattern matching. The user is responsible for freeing this memory; the <a class="reference internal" href="#project0hs__common_8h_1a8127f1c24ec8708d0284102d9b7bc082"><span>hs_free_database()</span></a> call should not be used.</p>
</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="c.hs_stream_size">
<span class="target" id="project0hs__common_8h_1a7cadd0a7ec7c50d8f6d52826635b9451"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t">hs_error_t</a> <code class="descname">hs_stream_size</code><span class="sig-paren">(</span>const  <a class="reference internal" href="#c.hs_database_t" title="hs_database_t">hs_database_t</a>  *<em>&nbsp;database</em>, size_t *<em>&nbsp;stream_size</em><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_stream_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Provides the size of the stream state allocated by a single stream opened against the given database.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd><a class="reference internal" href="#project0group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span>HS_SUCCESS</span></a> on success, other values on failure. </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last">
<li><code class="first docutils literal"><span class="pre">database</span></code> - <p>Pointer to a compiled (streaming mode) pattern database.</p>
</li>
<li><code class="first docutils literal"><span class="pre">stream_size</span></code> - <p>On success, the size in bytes of an individual stream opened against the given database is placed in this parameter.</p>
</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="c.hs_database_size">
<span class="target" id="project0hs__common_8h_1a54d7c123674f04578a58b84e625618e2"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t">hs_error_t</a> <code class="descname">hs_database_size</code><span class="sig-paren">(</span>const  <a class="reference internal" href="#c.hs_database_t" title="hs_database_t">hs_database_t</a>  *<em>&nbsp;database</em>, size_t *<em>&nbsp;database_size</em><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_database_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Provides the size of the given database in bytes.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd><a class="reference internal" href="#project0group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span>HS_SUCCESS</span></a> on success, other values on failure. </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last">
<li><code class="first docutils literal"><span class="pre">database</span></code> - <p>Pointer to compiled pattern database.</p>
</li>
<li><code class="first docutils literal"><span class="pre">database_size</span></code> - <p>On success, the size of the compiled database in bytes is placed in this parameter.</p>
</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="c.hs_serialized_database_size">
<span class="target" id="project0hs__common_8h_1a83006d0498780313470c84d67e9181b7"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t">hs_error_t</a> <code class="descname">hs_serialized_database_size</code><span class="sig-paren">(</span>const char *<em>&nbsp;bytes</em>, const size_t<em>&nbsp;length</em>, size_t *<em>&nbsp;deserialized_size</em><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_serialized_database_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Utility function for reporting the size that would be required by a database if it were deserialized.</p>
<p>This can be used to allocate a shared memory region or other &#8220;special&#8221; allocation prior to deserializing with the <a class="reference internal" href="#project0hs__common_8h_1a597f29547148e5378812be9a19d7f4cd"><span>hs_deserialize_database_at()</span></a> function.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd><a class="reference internal" href="#project0group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span>HS_SUCCESS</span></a> on success, other values on failure. </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last">
<li><code class="first docutils literal"><span class="pre">bytes</span></code> - <p>Pointer to a byte array generated by <a class="reference internal" href="#project0hs__common_8h_1accea8a4a5481683e0564058621c9b8de"><span>hs_serialize_database()</span></a> representing a compiled pattern database.</p>
</li>
<li><code class="first docutils literal"><span class="pre">length</span></code> - <p>The length of the byte array generated by <a class="reference internal" href="#project0hs__common_8h_1accea8a4a5481683e0564058621c9b8de"><span>hs_serialize_database()</span></a>. This should be the same value as that returned by <a class="reference internal" href="#project0hs__common_8h_1accea8a4a5481683e0564058621c9b8de"><span>hs_serialize_database()</span></a>.</p>
</li>
<li><code class="first docutils literal"><span class="pre">deserialized_size</span></code> - <p>On success, the size of the compiled database that would be generated by <a class="reference internal" href="#project0hs__common_8h_1a597f29547148e5378812be9a19d7f4cd"><span>hs_deserialize_database_at()</span></a> is returned here.</p>
</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="c.hs_database_info">
<span class="target" id="project0hs__common_8h_1a1a3e15ded02d1731bd761fc71d1a6246"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t">hs_error_t</a> <code class="descname">hs_database_info</code><span class="sig-paren">(</span>const  <a class="reference internal" href="#c.hs_database_t" title="hs_database_t">hs_database_t</a>  *<em>&nbsp;database</em>, char **<em>&nbsp;info</em><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_database_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Utility function providing information about a database.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd><a class="reference internal" href="#project0group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span>HS_SUCCESS</span></a> on success, other values on failure. </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last">
<li><code class="first docutils literal"><span class="pre">database</span></code> - <p>Pointer to a compiled database.</p>
</li>
<li><code class="first docutils literal"><span class="pre">info</span></code> - <p>On success, a string containing the version and platform information for the supplied database is placed in the parameter. The string is allocated using the allocator supplied in <a class="reference internal" href="#project0hs__common_8h_1a28571486e60e29b54d6b5fcf9ec1e0b1"><span>hs_set_misc_allocator()</span></a> (or malloc() if no allocator was set) and should be freed by the caller.</p>
</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="c.hs_serialized_database_info">
<span class="target" id="project0hs__common_8h_1adb78b881b1526fd85be4492c1d52e478"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t">hs_error_t</a> <code class="descname">hs_serialized_database_info</code><span class="sig-paren">(</span>const char *<em>&nbsp;bytes</em>, size_t<em>&nbsp;length</em>, char **<em>&nbsp;info</em><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_serialized_database_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Utility function providing information about a serialized database.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd><a class="reference internal" href="#project0group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span>HS_SUCCESS</span></a> on success, other values on failure. </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last">
<li><code class="first docutils literal"><span class="pre">bytes</span></code> - <p>Pointer to a serialized database.</p>
</li>
<li><code class="first docutils literal"><span class="pre">length</span></code> - <p>Length in bytes of the serialized database.</p>
</li>
<li><code class="first docutils literal"><span class="pre">info</span></code> - <p>On success, a string containing the version and platform information for the supplied serialized database is placed in the parameter. The string is allocated using the allocator supplied in <a class="reference internal" href="#project0hs__common_8h_1a28571486e60e29b54d6b5fcf9ec1e0b1"><span>hs_set_misc_allocator()</span></a> (or malloc() if no allocator was set) and should be freed by the caller.</p>
</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="c.hs_set_allocator">
<span class="target" id="project0hs__common_8h_1a5ca2c6de1dac5bb462e5cf4ab14de3bb"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t">hs_error_t</a> <code class="descname">hs_set_allocator</code><span class="sig-paren">(</span><a class="reference internal" href="#c.hs_alloc_t" title="hs_alloc_t">hs_alloc_t</a><em>&nbsp;alloc_func</em>, <a class="reference internal" href="#c.hs_free_t" title="hs_free_t">hs_free_t</a><em>&nbsp;free_func</em><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_set_allocator" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the allocate and free functions used by Hyperscan for allocating memory at runtime for stream state, scratch space, database bytecode, and various other data structure returned by the Hyperscan API.</p>
<p>The function is equivalent to calling <a class="reference internal" href="#project0hs__common_8h_1a1815c5493f89e85b7bc0557a4f89179d"><span>hs_set_stream_allocator()</span></a>, <a class="reference internal" href="#project0hs__common_8h_1a29e53465b9737c222bda3e7bcb324d61"><span>hs_set_scratch_allocator()</span></a>, <a class="reference internal" href="#project0hs__common_8h_1a0aaadd0fc97838f728fa220024be2509"><span>hs_set_database_allocator()</span></a> and <a class="reference internal" href="#project0hs__common_8h_1a28571486e60e29b54d6b5fcf9ec1e0b1"><span>hs_set_misc_allocator()</span></a> with the provided parameters.</p>
<p>This call will override any previous allocators that have been set.</p>
<p>Note: there is no way to change the allocator used for temporary objects created during the various compile calls (<a class="reference internal" href="#project0hs__compile_8h_1aeb302c749c316b296e3c3cdaa8508e73"><span>hs_compile()</span></a>, <a class="reference internal" href="#project0hs__compile_8h_1ae61b23042fd72756fb774bb87c581e84"><span>hs_compile_multi()</span></a>, <a class="reference internal" href="#project0hs__compile_8h_1aacc508bea3042f1faba32c3818bfc2a3"><span>hs_compile_ext_multi()</span></a>).</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd><a class="reference internal" href="#project0group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span>HS_SUCCESS</span></a> on success, other values on failure. </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last">
<li><code class="first docutils literal"><span class="pre">alloc_func</span></code> - <p>A callback function pointer that allocates memory. This function must return memory suitably aligned for the largest representable data type on this platform.</p>
</li>
<li><code class="first docutils literal"><span class="pre">free_func</span></code> - <p>A callback function pointer that frees allocated memory.</p>
</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="c.hs_set_database_allocator">
<span class="target" id="project0hs__common_8h_1a0aaadd0fc97838f728fa220024be2509"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t">hs_error_t</a> <code class="descname">hs_set_database_allocator</code><span class="sig-paren">(</span><a class="reference internal" href="#c.hs_alloc_t" title="hs_alloc_t">hs_alloc_t</a><em>&nbsp;alloc_func</em>, <a class="reference internal" href="#c.hs_free_t" title="hs_free_t">hs_free_t</a><em>&nbsp;free_func</em><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_set_database_allocator" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the allocate and free functions used by Hyperscan for allocating memory for database bytecode produced by the compile calls (<a class="reference internal" href="#project0hs__compile_8h_1aeb302c749c316b296e3c3cdaa8508e73"><span>hs_compile()</span></a>, <a class="reference internal" href="#project0hs__compile_8h_1ae61b23042fd72756fb774bb87c581e84"><span>hs_compile_multi()</span></a>, <a class="reference internal" href="#project0hs__compile_8h_1aacc508bea3042f1faba32c3818bfc2a3"><span>hs_compile_ext_multi()</span></a>) and by database deserialization (<a class="reference internal" href="#project0hs__common_8h_1a87007f735bc81c5d3b5865dbd38ec5b7"><span>hs_deserialize_database()</span></a>).</p>
<p>If no database allocation functions are set, or if NULL is used in place of both parameters, then memory allocation will default to standard methods (such as the system malloc() and free() calls).</p>
<p>This call will override any previous database allocators that have been set.</p>
<p>Note: the database allocator may also be set by calling <a class="reference internal" href="#project0hs__common_8h_1a5ca2c6de1dac5bb462e5cf4ab14de3bb"><span>hs_set_allocator()</span></a>.</p>
<p>Note: there is no way to change how temporary objects created during the various compile calls (<a class="reference internal" href="#project0hs__compile_8h_1aeb302c749c316b296e3c3cdaa8508e73"><span>hs_compile()</span></a>, <a class="reference internal" href="#project0hs__compile_8h_1ae61b23042fd72756fb774bb87c581e84"><span>hs_compile_multi()</span></a>, <a class="reference internal" href="#project0hs__compile_8h_1aacc508bea3042f1faba32c3818bfc2a3"><span>hs_compile_ext_multi()</span></a>) are allocated.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd><a class="reference internal" href="#project0group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span>HS_SUCCESS</span></a> on success, other values on failure. </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last">
<li><code class="first docutils literal"><span class="pre">alloc_func</span></code> - <p>A callback function pointer that allocates memory. This function must return memory suitably aligned for the largest representable data type on this platform.</p>
</li>
<li><code class="first docutils literal"><span class="pre">free_func</span></code> - <p>A callback function pointer that frees allocated memory.</p>
</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="c.hs_set_misc_allocator">
<span class="target" id="project0hs__common_8h_1a28571486e60e29b54d6b5fcf9ec1e0b1"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t">hs_error_t</a> <code class="descname">hs_set_misc_allocator</code><span class="sig-paren">(</span><a class="reference internal" href="#c.hs_alloc_t" title="hs_alloc_t">hs_alloc_t</a><em>&nbsp;alloc_func</em>, <a class="reference internal" href="#c.hs_free_t" title="hs_free_t">hs_free_t</a><em>&nbsp;free_func</em><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_set_misc_allocator" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the allocate and free functions used by Hyperscan for allocating memory for items returned by the Hyperscan API such as <a class="reference internal" href="#project0hs__compile_8h_1a70478dae6603bdb6c1f46d80829ada8d"><span>hs_compile_error_t</span></a>, <a class="reference internal" href="#project0hs__compile_8h_1ad5498775e1679920539b6bd120dfbbe8"><span>hs_expr_info_t</span></a> and serialized databases.</p>
<p>If no misc allocation functions are set, or if NULL is used in place of both parameters, then memory allocation will default to standard methods (such as the system malloc() and free() calls).</p>
<p>This call will override any previous misc allocators that have been set.</p>
<p>Note: the misc allocator may also be set by calling <a class="reference internal" href="#project0hs__common_8h_1a5ca2c6de1dac5bb462e5cf4ab14de3bb"><span>hs_set_allocator()</span></a>.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd><a class="reference internal" href="#project0group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span>HS_SUCCESS</span></a> on success, other values on failure. </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last">
<li><code class="first docutils literal"><span class="pre">alloc_func</span></code> - <p>A callback function pointer that allocates memory. This function must return memory suitably aligned for the largest representable data type on this platform.</p>
</li>
<li><code class="first docutils literal"><span class="pre">free_func</span></code> - <p>A callback function pointer that frees allocated memory.</p>
</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="c.hs_set_scratch_allocator">
<span class="target" id="project0hs__common_8h_1a29e53465b9737c222bda3e7bcb324d61"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t">hs_error_t</a> <code class="descname">hs_set_scratch_allocator</code><span class="sig-paren">(</span><a class="reference internal" href="#c.hs_alloc_t" title="hs_alloc_t">hs_alloc_t</a><em>&nbsp;alloc_func</em>, <a class="reference internal" href="#c.hs_free_t" title="hs_free_t">hs_free_t</a><em>&nbsp;free_func</em><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_set_scratch_allocator" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the allocate and free functions used by Hyperscan for allocating memory for scratch space by <a class="reference internal" href="#project0hs__runtime_8h_1ac0ddcd0c2a40f445211e415522fa7078"><span>hs_alloc_scratch()</span></a> and <a class="reference internal" href="#project0hs__runtime_8h_1a5ccab293a24ee56fcb82c715a7dca861"><span>hs_clone_scratch()</span></a>.</p>
<p>If no scratch allocation functions are set, or if NULL is used in place of both parameters, then memory allocation will default to standard methods (such as the system malloc() and free() calls).</p>
<p>This call will override any previous scratch allocators that have been set.</p>
<p>Note: the scratch allocator may also be set by calling <a class="reference internal" href="#project0hs__common_8h_1a5ca2c6de1dac5bb462e5cf4ab14de3bb"><span>hs_set_allocator()</span></a>.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd><a class="reference internal" href="#project0group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span>HS_SUCCESS</span></a> on success, other values on failure. </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last">
<li><code class="first docutils literal"><span class="pre">alloc_func</span></code> - <p>A callback function pointer that allocates memory. This function must return memory suitably aligned for the largest representable data type on this platform.</p>
</li>
<li><code class="first docutils literal"><span class="pre">free_func</span></code> - <p>A callback function pointer that frees allocated memory.</p>
</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="c.hs_set_stream_allocator">
<span class="target" id="project0hs__common_8h_1a1815c5493f89e85b7bc0557a4f89179d"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t">hs_error_t</a> <code class="descname">hs_set_stream_allocator</code><span class="sig-paren">(</span><a class="reference internal" href="#c.hs_alloc_t" title="hs_alloc_t">hs_alloc_t</a><em>&nbsp;alloc_func</em>, <a class="reference internal" href="#c.hs_free_t" title="hs_free_t">hs_free_t</a><em>&nbsp;free_func</em><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_set_stream_allocator" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the allocate and free functions used by Hyperscan for allocating memory for stream state by <a class="reference internal" href="#project0hs__runtime_8h_1a54bc32490fdcc331d074e60169aeeda7"><span>hs_open_stream()</span></a>.</p>
<p>If no stream allocation functions are set, or if NULL is used in place of both parameters, then memory allocation will default to standard methods (such as the system malloc() and free() calls).</p>
<p>This call will override any previous stream allocators that have been set.</p>
<p>Note: the stream allocator may also be set by calling <a class="reference internal" href="#project0hs__common_8h_1a5ca2c6de1dac5bb462e5cf4ab14de3bb"><span>hs_set_allocator()</span></a>.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd><a class="reference internal" href="#project0group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span>HS_SUCCESS</span></a> on success, other values on failure. </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last">
<li><code class="first docutils literal"><span class="pre">alloc_func</span></code> - <p>A callback function pointer that allocates memory. This function must return memory suitably aligned for the largest representable data type on this platform.</p>
</li>
<li><code class="first docutils literal"><span class="pre">free_func</span></code> - <p>A callback function pointer that frees allocated memory.</p>
</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="c.hs_version">
<span class="target" id="project0hs__common_8h_1ace8095e448bfcf1ad9d15292b04483eb"></span>const char* <code class="descname">hs_version</code><span class="sig-paren">(</span>void<span class="sig-paren">)</span><a class="headerlink" href="#c.hs_version" title="Permalink to this definition">¶</a></dt>
<dd><p>Utility function for identifying this release version.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>A string containing the version number of this release build and the date of the build. It is allocated statically, so it does not need to be freed by the caller. </dd>
</dl>
</p>
</dd></dl>

</div>
</div>
<div class="section" id="file-hs-compile-h">
<h2>File: hs_compile.h<a class="headerlink" href="#file-hs-compile-h" title="Permalink to this headline">¶</a></h2>
<p>The Hyperscan compiler API definition. </p>
<p>Hyperscan is a high speed regular expression engine.</p>
<p>This header contains functions for compiling regular expressions into Hyperscan databases that can be used by the Hyperscan runtime. </p>
<div class="breathe-sectiondef container">
<p class="breathe-sectiondef-title rubric">Defines</p>
<dl class="define">
<dt id="c.HS_EXT_FLAG_MIN_OFFSET">
<span class="target" id="project0group__HS__EXT__FLAG_1ga8876e1c519442ec4feb47508e03a6c52"></span><code class="descname">HS_EXT_FLAG_MIN_OFFSET</code><a class="headerlink" href="#c.HS_EXT_FLAG_MIN_OFFSET" title="Permalink to this definition">¶</a></dt>
<dd><p>Flag indicating that the <a class="reference internal" href="#project0strucths__expr__ext_1a006843974cb05dbf16291da621a72fa9"><span>hs_expr_ext::min_offset</span></a> field is used. </p>
</dd></dl>

<dl class="define">
<dt id="c.HS_EXT_FLAG_MAX_OFFSET">
<span class="target" id="project0group__HS__EXT__FLAG_1ga7f68e1f3b5ad7c39165e56f294aab5f8"></span><code class="descname">HS_EXT_FLAG_MAX_OFFSET</code><a class="headerlink" href="#c.HS_EXT_FLAG_MAX_OFFSET" title="Permalink to this definition">¶</a></dt>
<dd><p>Flag indicating that the <a class="reference internal" href="#project0strucths__expr__ext_1a263c613f20c6b8ef30ca01785e0f55fc"><span>hs_expr_ext::max_offset</span></a> field is used. </p>
</dd></dl>

<dl class="define">
<dt id="c.HS_EXT_FLAG_MIN_LENGTH">
<span class="target" id="project0group__HS__EXT__FLAG_1ga08b4bfb7f87b2f768c470ede24a724b6"></span><code class="descname">HS_EXT_FLAG_MIN_LENGTH</code><a class="headerlink" href="#c.HS_EXT_FLAG_MIN_LENGTH" title="Permalink to this definition">¶</a></dt>
<dd><p>Flag indicating that the <a class="reference internal" href="#project0strucths__expr__ext_1a6afdac1e0bb89d9a76d6c91ed86a6fe8"><span>hs_expr_ext::min_length</span></a> field is used. </p>
</dd></dl>

<dl class="define">
<dt id="c.HS_FLAG_CASELESS">
<span class="target" id="project0group__HS__PATTERN__FLAG_1gac933fc9be6a6d3ea8eeb5532dd974236"></span><code class="descname">HS_FLAG_CASELESS</code><a class="headerlink" href="#c.HS_FLAG_CASELESS" title="Permalink to this definition">¶</a></dt>
<dd><p>Compile flag: Set case-insensitive matching.</p>
<p>This flag sets the expression to be matched case-insensitively by default. The expression may still use PCRE tokens (notably <code class="docutils literal"><span class="pre">(?i)</span></code> and <code class="docutils literal"><span class="pre">(?-i)</span></code>) to switch case-insensitive matching on and off. </p>
</dd></dl>

<dl class="define">
<dt id="c.HS_FLAG_DOTALL">
<span class="target" id="project0group__HS__PATTERN__FLAG_1gae7a43d25b9c00e34836ad752ad4eded5"></span><code class="descname">HS_FLAG_DOTALL</code><a class="headerlink" href="#c.HS_FLAG_DOTALL" title="Permalink to this definition">¶</a></dt>
<dd><p>Compile flag: Matching a <code class="docutils literal"><span class="pre">.</span></code> will not exclude newlines.</p>
<p>This flag sets any instances of the <code class="docutils literal"><span class="pre">.</span></code> token to match newline characters as well as all other characters. The PCRE specification states that the <code class="docutils literal"><span class="pre">.</span></code> token does not match newline characters by default, so without this flag the <code class="docutils literal"><span class="pre">.</span></code> token will not cross line boundaries. </p>
</dd></dl>

<dl class="define">
<dt id="c.HS_FLAG_MULTILINE">
<span class="target" id="project0group__HS__PATTERN__FLAG_1ga83f3cf5bad826b3fb874d88b0a0b00e8"></span><code class="descname">HS_FLAG_MULTILINE</code><a class="headerlink" href="#c.HS_FLAG_MULTILINE" title="Permalink to this definition">¶</a></dt>
<dd><p>Compile flag: Set multi-line anchoring.</p>
<p>This flag instructs the expression to make the <code class="docutils literal"><span class="pre">^</span></code> and <code class="docutils literal"><span class="pre">$</span></code> tokens match newline characters as well as the start and end of the stream. If this flag is not specified, the <code class="docutils literal"><span class="pre">^</span></code> token will only ever match at the start of a stream, and the <code class="docutils literal"><span class="pre">$</span></code> token will only ever match at the end of a stream within the guidelines of the PCRE specification. </p>
</dd></dl>

<dl class="define">
<dt id="c.HS_FLAG_SINGLEMATCH">
<span class="target" id="project0group__HS__PATTERN__FLAG_1gac987cb424f8e9a89721a3ebf251f017f"></span><code class="descname">HS_FLAG_SINGLEMATCH</code><a class="headerlink" href="#c.HS_FLAG_SINGLEMATCH" title="Permalink to this definition">¶</a></dt>
<dd><p>Compile flag: Set single-match only mode.</p>
<p>This flag sets the expression&#8217;s match ID to match at most once. In streaming mode, this means that the expression will return only a single match over the lifetime of the stream, rather than reporting every match as per standard Hyperscan semantics. In block mode or vectored mode, only the first match for each invocation of <a class="reference internal" href="#project0hs__runtime_8h_1a261656043947931ad9d826d158119e89"><span>hs_scan()</span></a> or <a class="reference internal" href="#project0hs__runtime_8h_1ad6b603921a1fd2ddf12230730d6634c6"><span>hs_scan_vector()</span></a> will be returned.</p>
<p>If multiple expressions in the database share the same match ID, then they either must all specify <a class="reference internal" href="#project0group__HS__PATTERN__FLAG_1gac987cb424f8e9a89721a3ebf251f017f"><span>HS_FLAG_SINGLEMATCH</span></a> or none of them specify <a class="reference internal" href="#project0group__HS__PATTERN__FLAG_1gac987cb424f8e9a89721a3ebf251f017f"><span>HS_FLAG_SINGLEMATCH</span></a>. If a group of expressions sharing a match ID specify the flag, then at most one match with the match ID will be generated per stream.</p>
<p>Note: The use of this flag in combination with <a class="reference internal" href="#project0group__HS__PATTERN__FLAG_1ga1cd26b5cd0255380c854e642b11ea476"><span>HS_FLAG_SOM_LEFTMOST</span></a> is not currently supported. </p>
</dd></dl>

<dl class="define">
<dt id="c.HS_FLAG_ALLOWEMPTY">
<span class="target" id="project0group__HS__PATTERN__FLAG_1gaf346b64d12d06635d6da22f5be9788be"></span><code class="descname">HS_FLAG_ALLOWEMPTY</code><a class="headerlink" href="#c.HS_FLAG_ALLOWEMPTY" title="Permalink to this definition">¶</a></dt>
<dd><p>Compile flag: Allow expressions that can match against empty buffers.</p>
<p>This flag instructs the compiler to allow expressions that can match against empty buffers, such as <code class="docutils literal"><span class="pre">.?</span></code>, <code class="docutils literal"><span class="pre">.*</span></code>, <code class="docutils literal"><span class="pre">(a|)</span></code>. Since Hyperscan can return every possible match for an expression, such expressions generally execute very slowly; the default behaviour is to return an error when an attempt to compile one is made. Using this flag will force the compiler to allow such an expression. </p>
</dd></dl>

<dl class="define">
<dt id="c.HS_FLAG_UTF8">
<span class="target" id="project0group__HS__PATTERN__FLAG_1ga8c95741825e963834f8f53dd545132bd"></span><code class="descname">HS_FLAG_UTF8</code><a class="headerlink" href="#c.HS_FLAG_UTF8" title="Permalink to this definition">¶</a></dt>
<dd><p>Compile flag: Enable UTF-8 mode for this expression.</p>
<p>This flag instructs Hyperscan to treat the pattern as a sequence of UTF-8 characters. The results of scanning invalid UTF-8 sequences with a Hyperscan library that has been compiled with one or more patterns using this flag are undefined. </p>
</dd></dl>

<dl class="define">
<dt id="c.HS_FLAG_UCP">
<span class="target" id="project0group__HS__PATTERN__FLAG_1ga5b80baf97382e0a314d6ed424033b27c"></span><code class="descname">HS_FLAG_UCP</code><a class="headerlink" href="#c.HS_FLAG_UCP" title="Permalink to this definition">¶</a></dt>
<dd><p>Compile flag: Enable Unicode property support for this expression.</p>
<p>This flag instructs Hyperscan to use Unicode properties, rather than the default ASCII interpretations, for character mnemonics like <code class="docutils literal"><span class="pre">\w</span></code> and <code class="docutils literal"><span class="pre">\s</span></code> as well as the POSIX character classes. It is only meaningful in conjunction with <a class="reference internal" href="#project0group__HS__PATTERN__FLAG_1ga8c95741825e963834f8f53dd545132bd"><span>HS_FLAG_UTF8</span></a>. </p>
</dd></dl>

<dl class="define">
<dt id="c.HS_FLAG_PREFILTER">
<span class="target" id="project0group__HS__PATTERN__FLAG_1gaf22d466addab2cf9f050cc8856baf685"></span><code class="descname">HS_FLAG_PREFILTER</code><a class="headerlink" href="#c.HS_FLAG_PREFILTER" title="Permalink to this definition">¶</a></dt>
<dd><p>Compile flag: Enable prefiltering mode for this expression.</p>
<p>This flag instructs Hyperscan to compile an &#8220;approximate&#8221; version of this pattern for use in a prefiltering application, even if Hyperscan does not support the pattern in normal operation.</p>
<p>The set of matches returned when this flag is used is guaranteed to be a superset of the matches specified by the non-prefiltering expression.</p>
<p>If the pattern contains pattern constructs not supported by Hyperscan (such as zero-width assertions, back-references or conditional references) these constructs will be replaced internally with broader constructs that may match more often.</p>
<p>Furthermore, in prefiltering mode Hyperscan may simplify a pattern that would otherwise return a &#8220;Pattern too large&#8221; error at compile time, or for performance reasons (subject to the matching guarantee above).</p>
<p>It is generally expected that the application will subsequently confirm prefilter matches with another regular expression matcher that can provide exact matches for the pattern.</p>
<p>Note: The use of this flag in combination with <a class="reference internal" href="#project0group__HS__PATTERN__FLAG_1ga1cd26b5cd0255380c854e642b11ea476"><span>HS_FLAG_SOM_LEFTMOST</span></a> is not currently supported. </p>
</dd></dl>

<dl class="define">
<dt id="c.HS_FLAG_SOM_LEFTMOST">
<span class="target" id="project0group__HS__PATTERN__FLAG_1ga1cd26b5cd0255380c854e642b11ea476"></span><code class="descname">HS_FLAG_SOM_LEFTMOST</code><a class="headerlink" href="#c.HS_FLAG_SOM_LEFTMOST" title="Permalink to this definition">¶</a></dt>
<dd><p>Compile flag: Enable leftmost start of match reporting.</p>
<p>This flag instructs Hyperscan to report the leftmost possible start of match offset when a match is reported for this expression. (By default, no start of match is returned.)</p>
<p>Enabling this behaviour may reduce performance and increase stream state requirements in streaming mode. </p>
</dd></dl>

<dl class="define">
<dt id="c.HS_CPU_FEATURES_AVX2">
<span class="target" id="project0group__HS__CPU__FEATURES__FLAG_1ga1ae675026897399f27c610251b5f14a1"></span><code class="descname">HS_CPU_FEATURES_AVX2</code><a class="headerlink" href="#c.HS_CPU_FEATURES_AVX2" title="Permalink to this definition">¶</a></dt>
<dd><p>CPU features flag - Intel(R) Advanced Vector Extensions 2 (Intel(R) AVX2)</p>
<p>Setting this flag indicates that the target platform supports AVX2 instructions. </p>
</dd></dl>

<dl class="define">
<dt id="c.HS_TUNE_FAMILY_GENERIC">
<span class="target" id="project0group__HS__TUNE__FLAG_1ga8432f59942aa4116d0bb89ea469c7f25"></span><code class="descname">HS_TUNE_FAMILY_GENERIC</code><a class="headerlink" href="#c.HS_TUNE_FAMILY_GENERIC" title="Permalink to this definition">¶</a></dt>
<dd><p>Tuning Parameter - Generic</p>
<p>This indicates that the compiled database should not be tuned for any particular target platform. </p>
</dd></dl>

<dl class="define">
<dt id="c.HS_TUNE_FAMILY_SNB">
<span class="target" id="project0group__HS__TUNE__FLAG_1ga03f9adc14171ba88fab2096cf4c85dd1"></span><code class="descname">HS_TUNE_FAMILY_SNB</code><a class="headerlink" href="#c.HS_TUNE_FAMILY_SNB" title="Permalink to this definition">¶</a></dt>
<dd><p>Tuning Parameter - Intel(R) microarchitecture code name Sandy Bridge</p>
<p>This indicates that the compiled database should be tuned for the Sandy Bridge microarchitecture. </p>
</dd></dl>

<dl class="define">
<dt id="c.HS_TUNE_FAMILY_IVB">
<span class="target" id="project0group__HS__TUNE__FLAG_1ga4450c117ef6d6e93e17738d104a6d6bf"></span><code class="descname">HS_TUNE_FAMILY_IVB</code><a class="headerlink" href="#c.HS_TUNE_FAMILY_IVB" title="Permalink to this definition">¶</a></dt>
<dd><p>Tuning Parameter - Intel(R) microarchitecture code name Ivy Bridge</p>
<p>This indicates that the compiled database should be tuned for the Ivy Bridge microarchitecture. </p>
</dd></dl>

<dl class="define">
<dt id="c.HS_TUNE_FAMILY_HSW">
<span class="target" id="project0group__HS__TUNE__FLAG_1gad0f321a370c54c685face8e280194440"></span><code class="descname">HS_TUNE_FAMILY_HSW</code><a class="headerlink" href="#c.HS_TUNE_FAMILY_HSW" title="Permalink to this definition">¶</a></dt>
<dd><p>Tuning Parameter - Intel(R) microarchitecture code name Haswell</p>
<p>This indicates that the compiled database should be tuned for the Haswell microarchitecture. </p>
</dd></dl>

<dl class="define">
<dt id="c.HS_TUNE_FAMILY_SLM">
<span class="target" id="project0group__HS__TUNE__FLAG_1ga921644d03211ed07e348d25c4ee4a6d9"></span><code class="descname">HS_TUNE_FAMILY_SLM</code><a class="headerlink" href="#c.HS_TUNE_FAMILY_SLM" title="Permalink to this definition">¶</a></dt>
<dd><p>Tuning Parameter - Intel(R) microarchitecture code name Silvermont</p>
<p>This indicates that the compiled database should be tuned for the Silvermont microarchitecture. </p>
</dd></dl>

<dl class="define">
<dt id="c.HS_TUNE_FAMILY_BDW">
<span class="target" id="project0group__HS__TUNE__FLAG_1gac36ec4d90f461d6889cbdf5f7713f2ae"></span><code class="descname">HS_TUNE_FAMILY_BDW</code><a class="headerlink" href="#c.HS_TUNE_FAMILY_BDW" title="Permalink to this definition">¶</a></dt>
<dd><p>Tuning Parameter - Intel(R) microarchitecture code name Broadwell</p>
<p>This indicates that the compiled database should be tuned for the Broadwell microarchitecture. </p>
</dd></dl>

<dl class="define">
<dt id="c.HS_MODE_BLOCK">
<span class="target" id="project0group__HS__MODE__FLAG_1ga494ea2cf28a49627e4d131e596f489c0"></span><code class="descname">HS_MODE_BLOCK</code><a class="headerlink" href="#c.HS_MODE_BLOCK" title="Permalink to this definition">¶</a></dt>
<dd><p>Compiler mode flag: Block scan (non-streaming) database. </p>
</dd></dl>

<dl class="define">
<dt id="c.HS_MODE_NOSTREAM">
<span class="target" id="project0group__HS__MODE__FLAG_1gadb61c31eca1b60fe0dba5b05c457a0ef"></span><code class="descname">HS_MODE_NOSTREAM</code><a class="headerlink" href="#c.HS_MODE_NOSTREAM" title="Permalink to this definition">¶</a></dt>
<dd><p>Compiler mode flag: Alias for <a class="reference internal" href="#project0group__HS__MODE__FLAG_1ga494ea2cf28a49627e4d131e596f489c0"><span>HS_MODE_BLOCK</span></a>. </p>
</dd></dl>

<dl class="define">
<dt id="c.HS_MODE_STREAM">
<span class="target" id="project0group__HS__MODE__FLAG_1ga0a0dddb84ee8a5b7c012fdaf3780ffb0"></span><code class="descname">HS_MODE_STREAM</code><a class="headerlink" href="#c.HS_MODE_STREAM" title="Permalink to this definition">¶</a></dt>
<dd><p>Compiler mode flag: Streaming database. </p>
</dd></dl>

<dl class="define">
<dt id="c.HS_MODE_VECTORED">
<span class="target" id="project0group__HS__MODE__FLAG_1gaa1e074c5476f9077ed9b9111740e17ce"></span><code class="descname">HS_MODE_VECTORED</code><a class="headerlink" href="#c.HS_MODE_VECTORED" title="Permalink to this definition">¶</a></dt>
<dd><p>Compiler mode flag: Vectored scanning database. </p>
</dd></dl>

<dl class="define">
<dt id="c.HS_MODE_SOM_HORIZON_LARGE">
<span class="target" id="project0group__HS__MODE__FLAG_1gaae54cf9532a990b1ef7bdb4fa51eb3c6"></span><code class="descname">HS_MODE_SOM_HORIZON_LARGE</code><a class="headerlink" href="#c.HS_MODE_SOM_HORIZON_LARGE" title="Permalink to this definition">¶</a></dt>
<dd><p>Compiler mode flag: use full precision to track start of match offsets in stream state.</p>
<p>This mode will use the most stream state per pattern, but will always return an accurate start of match offset regardless of how far back in the past it was found.</p>
<p>One of the SOM_HORIZON modes must be selected to use the <a class="reference internal" href="#project0group__HS__PATTERN__FLAG_1ga1cd26b5cd0255380c854e642b11ea476"><span>HS_FLAG_SOM_LEFTMOST</span></a> expression flag. </p>
</dd></dl>

<dl class="define">
<dt id="c.HS_MODE_SOM_HORIZON_MEDIUM">
<span class="target" id="project0group__HS__MODE__FLAG_1gac96611d51f322cd0b20b536e73f8c5c5"></span><code class="descname">HS_MODE_SOM_HORIZON_MEDIUM</code><a class="headerlink" href="#c.HS_MODE_SOM_HORIZON_MEDIUM" title="Permalink to this definition">¶</a></dt>
<dd><p>Compiler mode flag: use medium precision to track start of match offsets in stream state.</p>
<p>This mode will use less stream state than <a class="reference internal" href="#project0group__HS__MODE__FLAG_1gaae54cf9532a990b1ef7bdb4fa51eb3c6"><span>HS_MODE_SOM_HORIZON_LARGE</span></a> and will limit start of match accuracy to offsets within 2^32 bytes of the end of match offset reported.</p>
<p>One of the SOM_HORIZON modes must be selected to use the <a class="reference internal" href="#project0group__HS__PATTERN__FLAG_1ga1cd26b5cd0255380c854e642b11ea476"><span>HS_FLAG_SOM_LEFTMOST</span></a> expression flag. </p>
</dd></dl>

<dl class="define">
<dt id="c.HS_MODE_SOM_HORIZON_SMALL">
<span class="target" id="project0group__HS__MODE__FLAG_1gad2e9e62af82d553dc0660f006227dd8f"></span><code class="descname">HS_MODE_SOM_HORIZON_SMALL</code><a class="headerlink" href="#c.HS_MODE_SOM_HORIZON_SMALL" title="Permalink to this definition">¶</a></dt>
<dd><p>Compiler mode flag: use limited precision to track start of match offsets in stream state.</p>
<p>This mode will use less stream state than <a class="reference internal" href="#project0group__HS__MODE__FLAG_1gaae54cf9532a990b1ef7bdb4fa51eb3c6"><span>HS_MODE_SOM_HORIZON_LARGE</span></a> and will limit start of match accuracy to offsets within 2^16 bytes of the end of match offset reported.</p>
<p>One of the SOM_HORIZON modes must be selected to use the <a class="reference internal" href="#project0group__HS__PATTERN__FLAG_1ga1cd26b5cd0255380c854e642b11ea476"><span>HS_FLAG_SOM_LEFTMOST</span></a> expression flag. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef container">
<p class="breathe-sectiondef-title rubric">Typedefs</p>
<dl class="typedef">
<dt id="c.hs_compile_error_t">
<span class="target" id="project0hs__compile_8h_1a70478dae6603bdb6c1f46d80829ada8d"></span><em class="property">typedef </em><code class="descname">hs_compile_error_t</code><a class="headerlink" href="#c.hs_compile_error_t" title="Permalink to this definition">¶</a></dt>
<dd><p>A type containing error details that is returned by the compile calls (<a class="reference internal" href="#project0hs__compile_8h_1aeb302c749c316b296e3c3cdaa8508e73"><span>hs_compile()</span></a>, <a class="reference internal" href="#project0hs__compile_8h_1ae61b23042fd72756fb774bb87c581e84"><span>hs_compile_multi()</span></a> and <a class="reference internal" href="#project0hs__compile_8h_1aacc508bea3042f1faba32c3818bfc2a3"><span>hs_compile_ext_multi()</span></a>) on failure. The caller may inspect the values returned in this type to determine the cause of failure.</p>
<p>Common errors generated during the compile process include:</p>
<p><ul>
<li><p class="first"><em>Invalid parameter</em></p>
<p>An invalid argument was specified in the compile call.</p>
</li>
<li><p class="first"><em>Unrecognised flag</em></p>
<p>An unrecognised value was passed in the flags argument.</p>
</li>
<li><p class="first"><em>Pattern matches empty buffer</em></p>
<p>By default, Hyperscan only supports patterns that will <em>always</em> consume at least one byte of input. Patterns that do not have this property (such as <code class="docutils literal"><span class="pre">/(abc)?/</span></code>) will produce this error unless the <a class="reference internal" href="#project0group__HS__PATTERN__FLAG_1gaf346b64d12d06635d6da22f5be9788be"><span>HS_FLAG_ALLOWEMPTY</span></a> flag is supplied. Note that such patterns will produce a match for <em>every</em> byte when scanned.</p>
</li>
<li><p class="first"><em>Embedded anchors not supported</em></p>
<p>Hyperscan only supports the use of anchor meta-characters (such as <code class="docutils literal"><span class="pre">^</span></code> and <code class="docutils literal"><span class="pre">$</span></code>) in patterns where they could <em>only</em> match at the start or end of a buffer. A pattern containing an embedded anchor, such as <code class="docutils literal"><span class="pre">/abc^def/</span></code>, can never match, as there is no way for <code class="docutils literal"><span class="pre">abc</span></code> to precede the start of the data stream.</p>
</li>
<li><p class="first"><em>Bounded repeat is too large</em></p>
<p>The pattern contains a repeated construct with very large finite bounds.</p>
</li>
<li><p class="first"><em>Unsupported component type</em></p>
<p>An unsupported PCRE construct was used in the pattern.</p>
</li>
<li><p class="first"><em>Unable to generate bytecode</em></p>
<p>This error indicates that Hyperscan was unable to compile a pattern that is syntactically valid. The most common cause is a pattern that is very long and complex or contains a large repeated subpattern.</p>
</li>
<li><p class="first"><em>Unable to allocate memory</em></p>
<p>The library was unable to allocate temporary storage used during compilation time.</p>
</li>
<li><p class="first"><em>Internal error</em></p>
<p>An unexpected error occurred: if this error is reported, please contact the Hyperscan team with a description of the situation. </p>
</li>
</ul>
</p>
</dd></dl>

<dl class="typedef">
<dt id="c.hs_platform_info_t">
<span class="target" id="project0hs__compile_8h_1a88f3b5576bfad796918225b9ee90cb99"></span><em class="property">typedef </em><code class="descname">hs_platform_info_t</code><a class="headerlink" href="#c.hs_platform_info_t" title="Permalink to this definition">¶</a></dt>
<dd><p>A type containing information on the target platform which may optionally be provided to the compile calls (<a class="reference internal" href="#project0hs__compile_8h_1aeb302c749c316b296e3c3cdaa8508e73"><span>hs_compile()</span></a>, <a class="reference internal" href="#project0hs__compile_8h_1ae61b23042fd72756fb774bb87c581e84"><span>hs_compile_multi()</span></a>, <a class="reference internal" href="#project0hs__compile_8h_1aacc508bea3042f1faba32c3818bfc2a3"><span>hs_compile_ext_multi()</span></a>).</p>
<p>A <a class="reference internal" href="#project0strucths__platform__info"><span>hs_platform_info</span></a> structure may be populated for the current platform by using the <a class="reference internal" href="#project0hs__compile_8h_1a7fba694199df776522bc959a43a0079c"><span>hs_populate_platform()</span></a> call. </p>
</dd></dl>

<dl class="typedef">
<dt id="c.hs_expr_info_t">
<span class="target" id="project0hs__compile_8h_1ad5498775e1679920539b6bd120dfbbe8"></span><em class="property">typedef </em><code class="descname">hs_expr_info_t</code><a class="headerlink" href="#c.hs_expr_info_t" title="Permalink to this definition">¶</a></dt>
<dd><p>A type containing information related to an expression that is returned by <a class="reference internal" href="#project0hs__compile_8h_1a414dfeeb4fee8d2444b531cef4bed0a4"><span>hs_expression_info()</span></a>. </p>
</dd></dl>

<dl class="typedef">
<dt id="c.hs_expr_ext_t">
<span class="target" id="project0hs__compile_8h_1a1e03f1d3837c16364ca2e96287b7eb34"></span><em class="property">typedef </em><code class="descname">hs_expr_ext_t</code><a class="headerlink" href="#c.hs_expr_ext_t" title="Permalink to this definition">¶</a></dt>
<dd><p>A structure containing additional parameters related to an expression, passed in at build time to <a class="reference internal" href="#project0hs__compile_8h_1aacc508bea3042f1faba32c3818bfc2a3"><span>hs_compile_ext_multi()</span></a>.</p>
<p>These parameters allow the set of matches produced by a pattern to be constrained at compile time, rather than relying on the application to process unwanted matches at runtime. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef container">
<p class="breathe-sectiondef-title rubric">Functions</p>
<dl class="function">
<dt id="c.hs_compile">
<span class="target" id="project0hs__compile_8h_1aeb302c749c316b296e3c3cdaa8508e73"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t">hs_error_t</a> <code class="descname">hs_compile</code><span class="sig-paren">(</span>const char *<em>&nbsp;expression</em>, unsigned int<em>&nbsp;flags</em>, unsigned int<em>&nbsp;mode</em>, const  <a class="reference internal" href="#c.hs_platform_info_t" title="hs_platform_info_t">hs_platform_info_t</a>  *<em>&nbsp;platform</em>, <a class="reference internal" href="#c.hs_database_t" title="hs_database_t">hs_database_t</a>  **<em>&nbsp;db</em>, <a class="reference internal" href="#c.hs_compile_error_t" title="hs_compile_error_t">hs_compile_error_t</a>  **<em>&nbsp;error</em><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_compile" title="Permalink to this definition">¶</a></dt>
<dd><p>The basic regular expression compiler.</p>
<p>This is the function call with which an expression is compiled into a Hyperscan database which can be passed to the runtime functions (such as <a class="reference internal" href="#project0hs__runtime_8h_1a261656043947931ad9d826d158119e89"><span>hs_scan()</span></a>, <a class="reference internal" href="#project0hs__runtime_8h_1a54bc32490fdcc331d074e60169aeeda7"><span>hs_open_stream()</span></a>, etc.)</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd><a class="reference internal" href="#project0group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span>HS_SUCCESS</span></a> is returned on successful compilation; <a class="reference internal" href="#project0group__HS__ERROR_1gae73b85ba0cafa46768c9b61f435410ca"><span>HS_COMPILER_ERROR</span></a> on failure, with details provided in the error parameter. </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last">
<li><code class="first docutils literal"><span class="pre">expression</span></code> - <p>The NULL-terminated expression to parse. Note that this string must represent ONLY the pattern to be matched, with no delimiters or flags; any global flags should be specified with the <em>flags</em> argument. For example, the expression <code class="docutils literal"><span class="pre">/abc?def/i</span></code> should be compiled by providing <code class="docutils literal"><span class="pre">abc?def</span></code> as the <em>expression</em>, and <a class="reference internal" href="#project0group__HS__PATTERN__FLAG_1gac933fc9be6a6d3ea8eeb5532dd974236"><span>HS_FLAG_CASELESS</span></a> as the <em>flags</em>.</p>
</li>
<li><code class="first docutils literal"><span class="pre">flags</span></code> - <p>Flags which modify the behaviour of the expression. Multiple flags may be used by ORing them together. Valid values are:<ul class="simple">
<li>HS_FLAG_CASELESS - Matching will be performed case-insensitively.</li>
<li>HS_FLAG_DOTALL - Matching a <code class="docutils literal"><span class="pre">.</span></code> will not exclude newlines.</li>
<li>HS_FLAG_MULTILINE - <code class="docutils literal"><span class="pre">^</span></code> and <code class="docutils literal"><span class="pre">$</span></code> anchors match any newlines in data.</li>
<li>HS_FLAG_SINGLEMATCH - Only one match will be generated for the expression per stream.</li>
<li>HS_FLAG_ALLOWEMPTY - Allow expressions which can match against an empty string, such as <code class="docutils literal"><span class="pre">.*</span></code>.</li>
<li>HS_FLAG_UTF8 - Treat this pattern as a sequence of UTF-8 characters.</li>
<li>HS_FLAG_UCP - Use Unicode properties for character classes.</li>
<li>HS_FLAG_PREFILTER - Compile pattern in prefiltering mode.</li>
<li>HS_FLAG_SOM_LEFTMOST - Report the leftmost start of match offset when a match is found.</li>
</ul>
</p>
</li>
<li><code class="first docutils literal"><span class="pre">mode</span></code> - <p>Compiler mode flags that affect the database as a whole. One of <a class="reference internal" href="#project0group__HS__MODE__FLAG_1ga0a0dddb84ee8a5b7c012fdaf3780ffb0"><span>HS_MODE_STREAM</span></a> or <a class="reference internal" href="#project0group__HS__MODE__FLAG_1ga494ea2cf28a49627e4d131e596f489c0"><span>HS_MODE_BLOCK</span></a> or <a class="reference internal" href="#project0group__HS__MODE__FLAG_1gaa1e074c5476f9077ed9b9111740e17ce"><span>HS_MODE_VECTORED</span></a> must be supplied, to select between the generation of a streaming, block or vectored database. In addition, other flags (beginning with HS_MODE_) may be supplied to enable specific features. See Compile mode flags for more details.</p>
</li>
<li><code class="first docutils literal"><span class="pre">platform</span></code> - <p>If not NULL, the platform structure is used to determine the target platform for the database. If NULL, a database suitable for running on the current host platform is produced.</p>
</li>
<li><code class="first docutils literal"><span class="pre">db</span></code> - <p>On success, a pointer to the generated database will be returned in this parameter, or NULL on failure. The caller is responsible for deallocating the buffer using the <a class="reference internal" href="#project0hs__common_8h_1a8127f1c24ec8708d0284102d9b7bc082"><span>hs_free_database()</span></a> function.</p>
</li>
<li><code class="first docutils literal"><span class="pre">error</span></code> - <p>If the compile fails, a pointer to a <a class="reference internal" href="#project0hs__compile_8h_1a70478dae6603bdb6c1f46d80829ada8d"><span>hs_compile_error_t</span></a> will be returned, providing details of the error condition. The caller is responsible for deallocating the buffer using the <a class="reference internal" href="#project0hs__compile_8h_1ad34e00fe031a7491722661b3defef81f"><span>hs_free_compile_error()</span></a> function.</p>
</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="c.hs_compile_multi">
<span class="target" id="project0hs__compile_8h_1ae61b23042fd72756fb774bb87c581e84"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t">hs_error_t</a> <code class="descname">hs_compile_multi</code><span class="sig-paren">(</span>const char *const *<em>&nbsp;expressions</em>, const unsigned int *<em>&nbsp;flags</em>, const unsigned int *<em>&nbsp;ids</em>, unsigned int<em>&nbsp;elements</em>, unsigned int<em>&nbsp;mode</em>, const  <a class="reference internal" href="#c.hs_platform_info_t" title="hs_platform_info_t">hs_platform_info_t</a>  *<em>&nbsp;platform</em>, <a class="reference internal" href="#c.hs_database_t" title="hs_database_t">hs_database_t</a>  **<em>&nbsp;db</em>, <a class="reference internal" href="#c.hs_compile_error_t" title="hs_compile_error_t">hs_compile_error_t</a>  **<em>&nbsp;error</em><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_compile_multi" title="Permalink to this definition">¶</a></dt>
<dd><p>The multiple regular expression compiler.</p>
<p>This is the function call with which a set of expressions is compiled into a database which can be passed to the runtime functions (such as <a class="reference internal" href="#project0hs__runtime_8h_1a261656043947931ad9d826d158119e89"><span>hs_scan()</span></a>, <a class="reference internal" href="#project0hs__runtime_8h_1a54bc32490fdcc331d074e60169aeeda7"><span>hs_open_stream()</span></a>, etc.) Each expression can be labelled with a unique integer which is passed into the match callback to identify the pattern that has matched.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd><a class="reference internal" href="#project0group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span>HS_SUCCESS</span></a> is returned on successful compilation; <a class="reference internal" href="#project0group__HS__ERROR_1gae73b85ba0cafa46768c9b61f435410ca"><span>HS_COMPILER_ERROR</span></a> on failure, with details provided in the <em>error</em> parameter. </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last">
<li><code class="first docutils literal"><span class="pre">expressions</span></code> - <p>Array of NULL-terminated expressions to compile. Note that (as for <a class="reference internal" href="#project0hs__compile_8h_1aeb302c749c316b296e3c3cdaa8508e73"><span>hs_compile()</span></a>) these strings must contain only the pattern to be matched, with no delimiters or flags. For example, the expression <code class="docutils literal"><span class="pre">/abc?def/i</span></code> should be compiled by providing <code class="docutils literal"><span class="pre">abc?def</span></code> as the first string in the <em>expressions</em> array, and <a class="reference internal" href="#project0group__HS__PATTERN__FLAG_1gac933fc9be6a6d3ea8eeb5532dd974236"><span>HS_FLAG_CASELESS</span></a> as the first value in the <em>flags</em> array.</p>
</li>
<li><code class="first docutils literal"><span class="pre">flags</span></code> - <p>Array of flags which modify the behaviour of each expression. Multiple flags may be used by ORing them together. Specifying the NULL pointer in place of an array will set the flags value for all patterns to zero. Valid values are:<ul class="simple">
<li>HS_FLAG_CASELESS - Matching will be performed case-insensitively.</li>
<li>HS_FLAG_DOTALL - Matching a <code class="docutils literal"><span class="pre">.</span></code> will not exclude newlines.</li>
<li>HS_FLAG_MULTILINE - <code class="docutils literal"><span class="pre">^</span></code> and <code class="docutils literal"><span class="pre">$</span></code> anchors match any newlines in data.</li>
<li>HS_FLAG_SINGLEMATCH - Only one match will be generated by patterns with this match id per stream.</li>
<li>HS_FLAG_ALLOWEMPTY - Allow expressions which can match against an empty string, such as <code class="docutils literal"><span class="pre">.*</span></code>.</li>
<li>HS_FLAG_UTF8 - Treat this pattern as a sequence of UTF-8 characters.</li>
<li>HS_FLAG_UCP - Use Unicode properties for character classes.</li>
<li>HS_FLAG_PREFILTER - Compile pattern in prefiltering mode.</li>
<li>HS_FLAG_SOM_LEFTMOST - Report the leftmost start of match offset when a match is found.</li>
</ul>
</p>
</li>
<li><code class="first docutils literal"><span class="pre">ids</span></code> - <p>An array of integers specifying the ID number to be associated with the corresponding pattern in the expressions array. Specifying the NULL pointer in place of an array will set the ID value for all patterns to zero.</p>
</li>
<li><code class="first docutils literal"><span class="pre">elements</span></code> - <p>The number of elements in the input arrays.</p>
</li>
<li><code class="first docutils literal"><span class="pre">mode</span></code> - <p>Compiler mode flags that affect the database as a whole. One of <a class="reference internal" href="#project0group__HS__MODE__FLAG_1ga0a0dddb84ee8a5b7c012fdaf3780ffb0"><span>HS_MODE_STREAM</span></a> or <a class="reference internal" href="#project0group__HS__MODE__FLAG_1ga494ea2cf28a49627e4d131e596f489c0"><span>HS_MODE_BLOCK</span></a> or <a class="reference internal" href="#project0group__HS__MODE__FLAG_1gaa1e074c5476f9077ed9b9111740e17ce"><span>HS_MODE_VECTORED</span></a> must be supplied, to select between the generation of a streaming, block or vectored database. In addition, other flags (beginning with HS_MODE_) may be supplied to enable specific features. See Compile mode flags for more details.</p>
</li>
<li><code class="first docutils literal"><span class="pre">platform</span></code> - <p>If not NULL, the platform structure is used to determine the target platform for the database. If NULL, a database suitable for running on the current host platform is produced.</p>
</li>
<li><code class="first docutils literal"><span class="pre">db</span></code> - <p>On success, a pointer to the generated database will be returned in this parameter, or NULL on failure. The caller is responsible for deallocating the buffer using the <a class="reference internal" href="#project0hs__common_8h_1a8127f1c24ec8708d0284102d9b7bc082"><span>hs_free_database()</span></a> function.</p>
</li>
<li><code class="first docutils literal"><span class="pre">error</span></code> - <p>If the compile fails, a pointer to a <a class="reference internal" href="#project0hs__compile_8h_1a70478dae6603bdb6c1f46d80829ada8d"><span>hs_compile_error_t</span></a> will be returned, providing details of the error condition. The caller is responsible for deallocating the buffer using the <a class="reference internal" href="#project0hs__compile_8h_1ad34e00fe031a7491722661b3defef81f"><span>hs_free_compile_error()</span></a> function.</p>
</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="c.hs_compile_ext_multi">
<span class="target" id="project0hs__compile_8h_1aacc508bea3042f1faba32c3818bfc2a3"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t">hs_error_t</a> <code class="descname">hs_compile_ext_multi</code><span class="sig-paren">(</span>const char *const *<em>&nbsp;expressions</em>, const unsigned int *<em>&nbsp;flags</em>, const unsigned int *<em>&nbsp;ids</em>, const  <a class="reference internal" href="#c.hs_expr_ext_t" title="hs_expr_ext_t">hs_expr_ext_t</a>  *const *<em>&nbsp;ext</em>, unsigned int<em>&nbsp;elements</em>, unsigned int<em>&nbsp;mode</em>, const  <a class="reference internal" href="#c.hs_platform_info_t" title="hs_platform_info_t">hs_platform_info_t</a>  *<em>&nbsp;platform</em>, <a class="reference internal" href="#c.hs_database_t" title="hs_database_t">hs_database_t</a>  **<em>&nbsp;db</em>, <a class="reference internal" href="#c.hs_compile_error_t" title="hs_compile_error_t">hs_compile_error_t</a>  **<em>&nbsp;error</em><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_compile_ext_multi" title="Permalink to this definition">¶</a></dt>
<dd><p>The multiple regular expression compiler with extended pattern support.</p>
<p>This function call compiles a group of expressions into a database in the same way as <a class="reference internal" href="#project0hs__compile_8h_1ae61b23042fd72756fb774bb87c581e84"><span>hs_compile_multi()</span></a>, but allows additional parameters to be specified via an <a class="reference internal" href="#project0hs__compile_8h_1a1e03f1d3837c16364ca2e96287b7eb34"><span>hs_expr_ext_t</span></a> structure per expression.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd><a class="reference internal" href="#project0group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span>HS_SUCCESS</span></a> is returned on successful compilation; <a class="reference internal" href="#project0group__HS__ERROR_1gae73b85ba0cafa46768c9b61f435410ca"><span>HS_COMPILER_ERROR</span></a> on failure, with details provided in the <em>error</em> parameter. </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last">
<li><code class="first docutils literal"><span class="pre">expressions</span></code> - <p>Array of NULL-terminated expressions to compile. Note that (as for <a class="reference internal" href="#project0hs__compile_8h_1aeb302c749c316b296e3c3cdaa8508e73"><span>hs_compile()</span></a>) these strings must contain only the pattern to be matched, with no delimiters or flags. For example, the expression <code class="docutils literal"><span class="pre">/abc?def/i</span></code> should be compiled by providing <code class="docutils literal"><span class="pre">abc?def</span></code> as the first string in the <em>expressions</em> array, and <a class="reference internal" href="#project0group__HS__PATTERN__FLAG_1gac933fc9be6a6d3ea8eeb5532dd974236"><span>HS_FLAG_CASELESS</span></a> as the first value in the <em>flags</em> array.</p>
</li>
<li><code class="first docutils literal"><span class="pre">flags</span></code> - <p>Array of flags which modify the behaviour of each expression. Multiple flags may be used by ORing them together. Specifying the NULL pointer in place of an array will set the flags value for all patterns to zero. Valid values are:<ul class="simple">
<li>HS_FLAG_CASELESS - Matching will be performed case-insensitively.</li>
<li>HS_FLAG_DOTALL - Matching a <code class="docutils literal"><span class="pre">.</span></code> will not exclude newlines.</li>
<li>HS_FLAG_MULTILINE - <code class="docutils literal"><span class="pre">^</span></code> and <code class="docutils literal"><span class="pre">$</span></code> anchors match any newlines in data.</li>
<li>HS_FLAG_SINGLEMATCH - Only one match will be generated by patterns with this match id per stream.</li>
<li>HS_FLAG_ALLOWEMPTY - Allow expressions which can match against an empty string, such as <code class="docutils literal"><span class="pre">.*</span></code>.</li>
<li>HS_FLAG_UTF8 - Treat this pattern as a sequence of UTF-8 characters.</li>
<li>HS_FLAG_UCP - Use Unicode properties for character classes.</li>
<li>HS_FLAG_PREFILTER - Compile pattern in prefiltering mode.</li>
<li>HS_FLAG_SOM_LEFTMOST - Report the leftmost start of match offset when a match is found.</li>
</ul>
</p>
</li>
<li><code class="first docutils literal"><span class="pre">ids</span></code> - <p>An array of integers specifying the ID number to be associated with the corresponding pattern in the expressions array. Specifying the NULL pointer in place of an array will set the ID value for all patterns to zero.</p>
</li>
<li><code class="first docutils literal"><span class="pre">ext</span></code> - <p>An array of pointers to filled <a class="reference internal" href="#project0hs__compile_8h_1a1e03f1d3837c16364ca2e96287b7eb34"><span>hs_expr_ext_t</span></a> structures that define extended behaviour for each pattern. NULL may be specified if no extended behaviour is needed for an individual pattern, or in place of the whole array if it is not needed for any expressions. Memory used by these structures must be both allocated and freed by the caller.</p>
</li>
<li><code class="first docutils literal"><span class="pre">elements</span></code> - <p>The number of elements in the input arrays.</p>
</li>
<li><code class="first docutils literal"><span class="pre">mode</span></code> - <p>Compiler mode flags that affect the database as a whole. One of <a class="reference internal" href="#project0group__HS__MODE__FLAG_1ga0a0dddb84ee8a5b7c012fdaf3780ffb0"><span>HS_MODE_STREAM</span></a>, <a class="reference internal" href="#project0group__HS__MODE__FLAG_1ga494ea2cf28a49627e4d131e596f489c0"><span>HS_MODE_BLOCK</span></a> or <a class="reference internal" href="#project0group__HS__MODE__FLAG_1gaa1e074c5476f9077ed9b9111740e17ce"><span>HS_MODE_VECTORED</span></a> must be supplied, to select between the generation of a streaming, block or vectored database. In addition, other flags (beginning with HS_MODE_) may be supplied to enable specific features. See Compile mode flags for more details.</p>
</li>
<li><code class="first docutils literal"><span class="pre">platform</span></code> - <p>If not NULL, the platform structure is used to determine the target platform for the database. If NULL, a database suitable for running on the current host platform is produced.</p>
</li>
<li><code class="first docutils literal"><span class="pre">db</span></code> - <p>On success, a pointer to the generated database will be returned in this parameter, or NULL on failure. The caller is responsible for deallocating the buffer using the <a class="reference internal" href="#project0hs__common_8h_1a8127f1c24ec8708d0284102d9b7bc082"><span>hs_free_database()</span></a> function.</p>
</li>
<li><code class="first docutils literal"><span class="pre">error</span></code> - <p>If the compile fails, a pointer to a <a class="reference internal" href="#project0hs__compile_8h_1a70478dae6603bdb6c1f46d80829ada8d"><span>hs_compile_error_t</span></a> will be returned, providing details of the error condition. The caller is responsible for deallocating the buffer using the <a class="reference internal" href="#project0hs__compile_8h_1ad34e00fe031a7491722661b3defef81f"><span>hs_free_compile_error()</span></a> function.</p>
</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="c.hs_free_compile_error">
<span class="target" id="project0hs__compile_8h_1ad34e00fe031a7491722661b3defef81f"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t">hs_error_t</a> <code class="descname">hs_free_compile_error</code><span class="sig-paren">(</span><a class="reference internal" href="#c.hs_compile_error_t" title="hs_compile_error_t">hs_compile_error_t</a>  *<em>&nbsp;error</em><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_free_compile_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Free an error structure generated by <a class="reference internal" href="#project0hs__compile_8h_1aeb302c749c316b296e3c3cdaa8508e73"><span>hs_compile()</span></a>, <a class="reference internal" href="#project0hs__compile_8h_1ae61b23042fd72756fb774bb87c581e84"><span>hs_compile_multi()</span></a> or <a class="reference internal" href="#project0hs__compile_8h_1aacc508bea3042f1faba32c3818bfc2a3"><span>hs_compile_ext_multi()</span></a>.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd><a class="reference internal" href="#project0group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span>HS_SUCCESS</span></a> on success, other values on failure. </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last">
<li><code class="first docutils literal"><span class="pre">error</span></code> - <p>The <a class="reference internal" href="#project0hs__compile_8h_1a70478dae6603bdb6c1f46d80829ada8d"><span>hs_compile_error_t</span></a> to be freed. NULL may also be safely provided.</p>
</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="c.hs_expression_info">
<span class="target" id="project0hs__compile_8h_1a414dfeeb4fee8d2444b531cef4bed0a4"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t">hs_error_t</a> <code class="descname">hs_expression_info</code><span class="sig-paren">(</span>const char *<em>&nbsp;expression</em>, unsigned int<em>&nbsp;flags</em>, <a class="reference internal" href="#c.hs_expr_info_t" title="hs_expr_info_t">hs_expr_info_t</a>  **<em>&nbsp;info</em>, <a class="reference internal" href="#c.hs_compile_error_t" title="hs_compile_error_t">hs_compile_error_t</a>  **<em>&nbsp;error</em><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_expression_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Utility function providing information about a regular expression. The information provided in <a class="reference internal" href="#project0hs__compile_8h_1ad5498775e1679920539b6bd120dfbbe8"><span>hs_expr_info_t</span></a> includes the minimum and maximum width of a pattern match.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd><a class="reference internal" href="#project0group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span>HS_SUCCESS</span></a> is returned on successful compilation; <a class="reference internal" href="#project0group__HS__ERROR_1gae73b85ba0cafa46768c9b61f435410ca"><span>HS_COMPILER_ERROR</span></a> on failure, with details provided in the error parameter. </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last">
<li><code class="first docutils literal"><span class="pre">expression</span></code> - <p>The NULL-terminated expression to parse. Note that this string must represent ONLY the pattern to be matched, with no delimiters or flags; any global flags should be specified with the <em>flags</em> argument. For example, the expression <code class="docutils literal"><span class="pre">/abc?def/i</span></code> should be compiled by providing <code class="docutils literal"><span class="pre">abc?def</span></code> as the <em>expression</em>, and <a class="reference internal" href="#project0group__HS__PATTERN__FLAG_1gac933fc9be6a6d3ea8eeb5532dd974236"><span>HS_FLAG_CASELESS</span></a> as the <em>flags</em>.</p>
</li>
<li><code class="first docutils literal"><span class="pre">flags</span></code> - <p>Flags which modify the behaviour of the expression. Multiple flags may be used by ORing them together. Valid values are:<ul class="simple">
<li>HS_FLAG_CASELESS - Matching will be performed case-insensitively.</li>
<li>HS_FLAG_DOTALL - Matching a <code class="docutils literal"><span class="pre">.</span></code> will not exclude newlines.</li>
<li>HS_FLAG_MULTILINE - <code class="docutils literal"><span class="pre">^</span></code> and <code class="docutils literal"><span class="pre">$</span></code> anchors match any newlines in data.</li>
<li>HS_FLAG_SINGLEMATCH - Only one match will be generated by the expression per stream.</li>
<li>HS_FLAG_ALLOWEMPTY - Allow expressions which can match against an empty string, such as <code class="docutils literal"><span class="pre">.*</span></code>.</li>
<li>HS_FLAG_UTF8 - Treat this pattern as a sequence of UTF-8 characters.</li>
<li>HS_FLAG_UCP - Use Unicode properties for character classes.</li>
<li>HS_FLAG_PREFILTER - Compile pattern in prefiltering mode.</li>
<li>HS_FLAG_SOM_LEFTMOST - Report the leftmost start of match offset when a match is found.</li>
</ul>
</p>
</li>
<li><code class="first docutils literal"><span class="pre">info</span></code> - <p>On success, a pointer to the pattern information will be returned in this parameter, or NULL on failure. This structure is allocated using the allocator supplied in <a class="reference internal" href="#project0hs__common_8h_1a5ca2c6de1dac5bb462e5cf4ab14de3bb"><span>hs_set_allocator()</span></a> (or malloc() if no allocator was set) and should be freed by the caller.</p>
</li>
<li><code class="first docutils literal"><span class="pre">error</span></code> - <p>If the call fails, a pointer to a <a class="reference internal" href="#project0hs__compile_8h_1a70478dae6603bdb6c1f46d80829ada8d"><span>hs_compile_error_t</span></a> will be returned, providing details of the error condition. The caller is responsible for deallocating the buffer using the <a class="reference internal" href="#project0hs__compile_8h_1ad34e00fe031a7491722661b3defef81f"><span>hs_free_compile_error()</span></a> function.</p>
</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="c.hs_populate_platform">
<span class="target" id="project0hs__compile_8h_1a7fba694199df776522bc959a43a0079c"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t">hs_error_t</a> <code class="descname">hs_populate_platform</code><span class="sig-paren">(</span><a class="reference internal" href="#c.hs_platform_info_t" title="hs_platform_info_t">hs_platform_info_t</a>  *<em>&nbsp;platform</em><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_populate_platform" title="Permalink to this definition">¶</a></dt>
<dd><p>Populates the platform information based on the current host.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd><a class="reference internal" href="#project0group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span>HS_SUCCESS</span></a> on success, other values on failure. </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last">
<li><code class="first docutils literal"><span class="pre">platform</span></code> - <p>On success, the pointed to structure is populated based on the current host.</p>
</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<dl class="struct">
<dt id="c.hs_compile_error">
<span class="target" id="project0strucths__compile__error"></span><em class="property">struct </em><code class="descname">hs_compile_error</code><a class="headerlink" href="#c.hs_compile_error" title="Permalink to this definition">¶</a></dt>
<dd><em>#include &lt;hs_compile.h&gt;</em><p>A type containing error details that is returned by the compile calls (<a class="reference internal" href="#project0hs__compile_8h_1aeb302c749c316b296e3c3cdaa8508e73"><span>hs_compile()</span></a>, <a class="reference internal" href="#project0hs__compile_8h_1ae61b23042fd72756fb774bb87c581e84"><span>hs_compile_multi()</span></a> and <a class="reference internal" href="#project0hs__compile_8h_1aacc508bea3042f1faba32c3818bfc2a3"><span>hs_compile_ext_multi()</span></a>) on failure. The caller may inspect the values returned in this type to determine the cause of failure.</p>
<p>Common errors generated during the compile process include:</p>
<p><ul>
<li><p class="first"><em>Invalid parameter</em></p>
<p>An invalid argument was specified in the compile call.</p>
</li>
<li><p class="first"><em>Unrecognised flag</em></p>
<p>An unrecognised value was passed in the flags argument.</p>
</li>
<li><p class="first"><em>Pattern matches empty buffer</em></p>
<p>By default, Hyperscan only supports patterns that will <em>always</em> consume at least one byte of input. Patterns that do not have this property (such as <code class="docutils literal"><span class="pre">/(abc)?/</span></code>) will produce this error unless the <a class="reference internal" href="#project0group__HS__PATTERN__FLAG_1gaf346b64d12d06635d6da22f5be9788be"><span>HS_FLAG_ALLOWEMPTY</span></a> flag is supplied. Note that such patterns will produce a match for <em>every</em> byte when scanned.</p>
</li>
<li><p class="first"><em>Embedded anchors not supported</em></p>
<p>Hyperscan only supports the use of anchor meta-characters (such as <code class="docutils literal"><span class="pre">^</span></code> and <code class="docutils literal"><span class="pre">$</span></code>) in patterns where they could <em>only</em> match at the start or end of a buffer. A pattern containing an embedded anchor, such as <code class="docutils literal"><span class="pre">/abc^def/</span></code>, can never match, as there is no way for <code class="docutils literal"><span class="pre">abc</span></code> to precede the start of the data stream.</p>
</li>
<li><p class="first"><em>Bounded repeat is too large</em></p>
<p>The pattern contains a repeated construct with very large finite bounds.</p>
</li>
<li><p class="first"><em>Unsupported component type</em></p>
<p>An unsupported PCRE construct was used in the pattern.</p>
</li>
<li><p class="first"><em>Unable to generate bytecode</em></p>
<p>This error indicates that Hyperscan was unable to compile a pattern that is syntactically valid. The most common cause is a pattern that is very long and complex or contains a large repeated subpattern.</p>
</li>
<li><p class="first"><em>Unable to allocate memory</em></p>
<p>The library was unable to allocate temporary storage used during compilation time.</p>
</li>
<li><p class="first"><em>Internal error</em></p>
<p>An unexpected error occurred: if this error is reported, please contact the Hyperscan team with a description of the situation. </p>
</li>
</ul>
</p>
<div class="breathe-sectiondef container">
<p class="breathe-sectiondef-title rubric">Public Members</p>
<dl class="variable">
<dt id="c.hs_compile_error::message">
<span class="target" id="project0strucths__compile__error_1a303cf95a1eec5a9fc3edae048cd85fbf"></span>char* <code class="descname">message</code><a class="headerlink" href="#c.hs_compile_error::message" title="Permalink to this definition">¶</a></dt>
<dd><p>A human-readable error message describing the error. </p>
</dd></dl>

<dl class="variable">
<dt id="c.hs_compile_error::expression">
<span class="target" id="project0strucths__compile__error_1afd4362e387e24e5328277719383f055a"></span>int <code class="descname">expression</code><a class="headerlink" href="#c.hs_compile_error::expression" title="Permalink to this definition">¶</a></dt>
<dd><p>The zero-based number of the expression that caused the error (if this can be determined). If the error is not specific to an expression, then this value will be less than zero. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="struct">
<dt id="c.hs_platform_info">
<span class="target" id="project0strucths__platform__info"></span><em class="property">struct </em><code class="descname">hs_platform_info</code><a class="headerlink" href="#c.hs_platform_info" title="Permalink to this definition">¶</a></dt>
<dd><em>#include &lt;hs_compile.h&gt;</em><p>A type containing information on the target platform which may optionally be provided to the compile calls (<a class="reference internal" href="#project0hs__compile_8h_1aeb302c749c316b296e3c3cdaa8508e73"><span>hs_compile()</span></a>, <a class="reference internal" href="#project0hs__compile_8h_1ae61b23042fd72756fb774bb87c581e84"><span>hs_compile_multi()</span></a>, <a class="reference internal" href="#project0hs__compile_8h_1aacc508bea3042f1faba32c3818bfc2a3"><span>hs_compile_ext_multi()</span></a>).</p>
<p>A <a class="reference internal" href="#project0strucths__platform__info"><span>hs_platform_info</span></a> structure may be populated for the current platform by using the <a class="reference internal" href="#project0hs__compile_8h_1a7fba694199df776522bc959a43a0079c"><span>hs_populate_platform()</span></a> call. </p>
<div class="breathe-sectiondef container">
<p class="breathe-sectiondef-title rubric">Public Members</p>
<dl class="variable">
<dt id="c.hs_platform_info::tune">
<span class="target" id="project0strucths__platform__info_1a8561393042c07099d545e03fda5512b7"></span>unsigned int <code class="descname">tune</code><a class="headerlink" href="#c.hs_platform_info::tune" title="Permalink to this definition">¶</a></dt>
<dd><p>Information about the target platform which may be used to guide the optimisation process of the compile.</p>
<p>Use of this field does not limit the processors that the resulting database can run on, but may impact the performance of the resulting database. </p>
</dd></dl>

<dl class="variable">
<dt id="c.hs_platform_info::cpu_features">
<span class="target" id="project0strucths__platform__info_1a29ad1841b85ee32b720e18c53f37450d"></span>unsigned long long <code class="descname">cpu_features</code><a class="headerlink" href="#c.hs_platform_info::cpu_features" title="Permalink to this definition">¶</a></dt>
<dd><p>Relevant CPU features available on the target platform</p>
<p>This value may be produced by combining HS_CPU_FEATURE_* flags (such as <a class="reference internal" href="#project0group__HS__CPU__FEATURES__FLAG_1ga1ae675026897399f27c610251b5f14a1"><span>HS_CPU_FEATURES_AVX2</span></a>). Multiple CPU features may be or&#8217;ed together to produce the value. </p>
</dd></dl>

<dl class="variable">
<dt id="c.hs_platform_info::reserved1">
<span class="target" id="project0strucths__platform__info_1a750e5d9803c909ecfa8109eacc1f37a2"></span>unsigned long long <code class="descname">reserved1</code><a class="headerlink" href="#c.hs_platform_info::reserved1" title="Permalink to this definition">¶</a></dt>
<dd><p>Reserved for future use. </p>
</dd></dl>

<dl class="variable">
<dt id="c.hs_platform_info::reserved2">
<span class="target" id="project0strucths__platform__info_1aec8841304b85f2ca488482ab47eae42b"></span>unsigned long long <code class="descname">reserved2</code><a class="headerlink" href="#c.hs_platform_info::reserved2" title="Permalink to this definition">¶</a></dt>
<dd><p>Reserved for future use. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="struct">
<dt id="c.hs_expr_info">
<span class="target" id="project0strucths__expr__info"></span><em class="property">struct </em><code class="descname">hs_expr_info</code><a class="headerlink" href="#c.hs_expr_info" title="Permalink to this definition">¶</a></dt>
<dd><em>#include &lt;hs_compile.h&gt;</em><p>A type containing information related to an expression that is returned by <a class="reference internal" href="#project0hs__compile_8h_1a414dfeeb4fee8d2444b531cef4bed0a4"><span>hs_expression_info()</span></a>. </p>
<div class="breathe-sectiondef container">
<p class="breathe-sectiondef-title rubric">Public Members</p>
<dl class="variable">
<dt id="c.hs_expr_info::min_width">
<span class="target" id="project0strucths__expr__info_1ae3988283e676fd604d3fd8f4b7f3958c"></span>unsigned int <code class="descname">min_width</code><a class="headerlink" href="#c.hs_expr_info::min_width" title="Permalink to this definition">¶</a></dt>
<dd><p>The minimum length in bytes of a match for the pattern. </p>
</dd></dl>

<dl class="variable">
<dt id="c.hs_expr_info::max_width">
<span class="target" id="project0strucths__expr__info_1ae728af1e67caaa6691e6bc4e8954bfec"></span>unsigned int <code class="descname">max_width</code><a class="headerlink" href="#c.hs_expr_info::max_width" title="Permalink to this definition">¶</a></dt>
<dd><p>The maximum length in bytes of a match for the pattern. If the pattern has an unbounded maximum width, this will be set to the maximum value of an unsigned int (UINT_MAX). </p>
</dd></dl>

<dl class="variable">
<dt id="c.hs_expr_info::unordered_matches">
<span class="target" id="project0strucths__expr__info_1ac19e2d22f86520ba745259df5fa22ec0"></span>char <code class="descname">unordered_matches</code><a class="headerlink" href="#c.hs_expr_info::unordered_matches" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether this expression can produce matches that are not returned in order, such as those produced by assertions. Zero if false, non-zero if true. </p>
</dd></dl>

<dl class="variable">
<dt id="c.hs_expr_info::matches_at_eod">
<span class="target" id="project0strucths__expr__info_1a050ce501ddfe9c67af0f271dc1f9a24c"></span>char <code class="descname">matches_at_eod</code><a class="headerlink" href="#c.hs_expr_info::matches_at_eod" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether this expression can produce matches at end of data (EOD). In streaming mode, EOD matches are raised during <a class="reference internal" href="#project0hs__runtime_8h_1a2471dfb1596b87fb95ea19124fae0940"><span>hs_close_stream()</span></a>, since it is only when <a class="reference internal" href="#project0hs__runtime_8h_1a2471dfb1596b87fb95ea19124fae0940"><span>hs_close_stream()</span></a> is called that the EOD location is known. Zero if false, non-zero if true.</p>
<p>Note: trailing <code class="docutils literal"><span class="pre">\b</span></code> word boundary assertions may also result in EOD matches as end-of-data can act as a word boundary. </p>
</dd></dl>

<dl class="variable">
<dt id="c.hs_expr_info::matches_only_at_eod">
<span class="target" id="project0strucths__expr__info_1a063c18ce23ccc7a7c4222e52ad8ad314"></span>char <code class="descname">matches_only_at_eod</code><a class="headerlink" href="#c.hs_expr_info::matches_only_at_eod" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether this expression can <em>only</em> produce matches at end of data (EOD). In streaming mode, all matches for this expression are raised during <a class="reference internal" href="#project0hs__runtime_8h_1a2471dfb1596b87fb95ea19124fae0940"><span>hs_close_stream()</span></a>. Zero if false, non-zero if true. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="struct">
<dt id="c.hs_expr_ext">
<span class="target" id="project0strucths__expr__ext"></span><em class="property">struct </em><code class="descname">hs_expr_ext</code><a class="headerlink" href="#c.hs_expr_ext" title="Permalink to this definition">¶</a></dt>
<dd><em>#include &lt;hs_compile.h&gt;</em><p>A structure containing additional parameters related to an expression, passed in at build time to <a class="reference internal" href="#project0hs__compile_8h_1aacc508bea3042f1faba32c3818bfc2a3"><span>hs_compile_ext_multi()</span></a>.</p>
<p>These parameters allow the set of matches produced by a pattern to be constrained at compile time, rather than relying on the application to process unwanted matches at runtime. </p>
<div class="breathe-sectiondef container">
<p class="breathe-sectiondef-title rubric">Public Members</p>
<dl class="variable">
<dt id="c.hs_expr_ext::flags">
<span class="target" id="project0strucths__expr__ext_1a290badd1e9b34fc37a53b93da1ee9c07"></span>unsigned long long <code class="descname">flags</code><a class="headerlink" href="#c.hs_expr_ext::flags" title="Permalink to this definition">¶</a></dt>
<dd><p>Flags governing which parts of this structure are to be used by the compiler. See hs_expr_ext_t flags. </p>
</dd></dl>

<dl class="variable">
<dt id="c.hs_expr_ext::min_offset">
<span class="target" id="project0strucths__expr__ext_1a006843974cb05dbf16291da621a72fa9"></span>unsigned long long <code class="descname">min_offset</code><a class="headerlink" href="#c.hs_expr_ext::min_offset" title="Permalink to this definition">¶</a></dt>
<dd><p>The minimum end offset in the data stream at which this expression should match successfully. To use this parameter, set the <a class="reference internal" href="#project0group__HS__EXT__FLAG_1ga8876e1c519442ec4feb47508e03a6c52"><span>HS_EXT_FLAG_MIN_OFFSET</span></a> flag in the <a class="reference internal" href="#project0strucths__expr__ext_1a290badd1e9b34fc37a53b93da1ee9c07"><span>hs_expr_ext::flags</span></a> field. </p>
</dd></dl>

<dl class="variable">
<dt id="c.hs_expr_ext::max_offset">
<span class="target" id="project0strucths__expr__ext_1a263c613f20c6b8ef30ca01785e0f55fc"></span>unsigned long long <code class="descname">max_offset</code><a class="headerlink" href="#c.hs_expr_ext::max_offset" title="Permalink to this definition">¶</a></dt>
<dd><p>The maximum end offset in the data stream at which this expression should match successfully. To use this parameter, set the <a class="reference internal" href="#project0group__HS__EXT__FLAG_1ga7f68e1f3b5ad7c39165e56f294aab5f8"><span>HS_EXT_FLAG_MAX_OFFSET</span></a> flag in the <a class="reference internal" href="#project0strucths__expr__ext_1a290badd1e9b34fc37a53b93da1ee9c07"><span>hs_expr_ext::flags</span></a> field. </p>
</dd></dl>

<dl class="variable">
<dt id="c.hs_expr_ext::min_length">
<span class="target" id="project0strucths__expr__ext_1a6afdac1e0bb89d9a76d6c91ed86a6fe8"></span>unsigned long long <code class="descname">min_length</code><a class="headerlink" href="#c.hs_expr_ext::min_length" title="Permalink to this definition">¶</a></dt>
<dd><p>The minimum match length (from start to end) required to successfully match this expression. To use this parameter, set the <a class="reference internal" href="#project0group__HS__EXT__FLAG_1ga08b4bfb7f87b2f768c470ede24a724b6"><span>HS_EXT_FLAG_MIN_LENGTH</span></a> flag in the <a class="reference internal" href="#project0strucths__expr__ext_1a290badd1e9b34fc37a53b93da1ee9c07"><span>hs_expr_ext::flags</span></a> field. </p>
</dd></dl>

</div>
</dd></dl>

</div>
<div class="section" id="file-hs-runtime-h">
<h2>File: hs_runtime.h<a class="headerlink" href="#file-hs-runtime-h" title="Permalink to this headline">¶</a></h2>
<p>The Hyperscan runtime API definition. </p>
<p>Hyperscan is a high speed regular expression engine.</p>
<p>This header contains functions for using compiled Hyperscan databases for scanning data at runtime. </p>
<div class="breathe-sectiondef container">
<p class="breathe-sectiondef-title rubric">Defines</p>
<dl class="define">
<dt id="c.HS_OFFSET_PAST_HORIZON">
<span class="target" id="project0hs__runtime_8h_1a5a2035b99ba414e593a41b41a5f41a36"></span><code class="descname">HS_OFFSET_PAST_HORIZON</code><a class="headerlink" href="#c.HS_OFFSET_PAST_HORIZON" title="Permalink to this definition">¶</a></dt>
<dd><p>Callback &#8216;from&#8217; return value, indicating that the start of this match was too early to be tracked with the requested SOM_HORIZON precision. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef container">
<p class="breathe-sectiondef-title rubric">Typedefs</p>
<dl class="typedef">
<dt id="c.hs_stream_t">
<span class="target" id="project0hs__runtime_8h_1a2ef982d1aaecd7b08c091d355c44e7f3"></span><em class="property">typedef </em><code class="descname">hs_stream_t</code><a class="headerlink" href="#c.hs_stream_t" title="Permalink to this definition">¶</a></dt>
<dd><p>The stream identifier returned by <a class="reference internal" href="#project0hs__runtime_8h_1a54bc32490fdcc331d074e60169aeeda7"><span>hs_open_stream()</span></a>. </p>
</dd></dl>

<dl class="typedef">
<dt id="c.hs_scratch_t">
<span class="target" id="project0hs__runtime_8h_1af0a89aeb8f5256f35c0bc86e8ca2a19b"></span><em class="property">typedef </em><code class="descname">hs_scratch_t</code><a class="headerlink" href="#c.hs_scratch_t" title="Permalink to this definition">¶</a></dt>
<dd><p>A Hyperscan scratch space. </p>
</dd></dl>

<dl class="typedef">
<dt id="c.match_event_handler">
<span class="target" id="project0hs__runtime_8h_1a8c0a6ab1493f9f5dacccfda985df4cd7"></span><em class="property">typedef </em><code class="descname">(* match_event_handler)</code><span class="sig-paren">(</span>unsigned int<em>&nbsp;id</em>, unsigned long long<em>&nbsp;from</em>, unsigned long long<em>&nbsp;to</em>, unsigned int<em>&nbsp;flags</em>, void<em>&nbsp;*context</em><span class="sig-paren">)</span><a class="headerlink" href="#c.match_event_handler" title="Permalink to this definition">¶</a></dt>
<dd><p>Definition of the match event callback function type.</p>
<p>A callback function matching the defined type must be provided by the application calling the <a class="reference internal" href="#project0hs__runtime_8h_1a261656043947931ad9d826d158119e89"><span>hs_scan()</span></a>, <a class="reference internal" href="#project0hs__runtime_8h_1ad6b603921a1fd2ddf12230730d6634c6"><span>hs_scan_vector()</span></a> or <a class="reference internal" href="#project0hs__runtime_8h_1a34d0eb9c280a58bbc29b19e22dead8b3"><span>hs_scan_stream()</span></a> functions (or other streaming calls which can produce matches).</p>
<p>This callback function will be invoked whenever a match is located in the target data during the execution of a scan. The details of the match are passed in as parameters to the callback function, and the callback function should return a value indicating whether or not matching should continue on the target data. If no callbacks are desired from a scan call, NULL may be provided in order to suppress match production.</p>
<p>This callback function should not attempt to call Hyperscan API functions on the same stream nor should it attempt to reuse the scratch space allocated for the API calls that caused it to be triggered. Making another call to the Hyperscan library with completely independent parameters should work (for example, scanning a different database in a new stream and with new scratch space), but reusing data structures like stream state and/or scratch space will produce undefined behavior.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>Non-zero if the matching should cease, else zero. If scanning is performed in streaming mode and a non-zero value is returned, any subsequent calls to <a class="reference internal" href="#project0hs__runtime_8h_1a34d0eb9c280a58bbc29b19e22dead8b3"><span>hs_scan_stream()</span></a> for that stream will immediately return with <a class="reference internal" href="#project0group__HS__ERROR_1ga122c9eb3b263d14360532e47c647fc16"><span>HS_SCAN_TERMINATED</span></a>. </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last">
<li><code class="first docutils literal"><span class="pre">id</span></code> - <p>The ID number of the expression that matched. If the expression was a single expression compiled with <a class="reference internal" href="#project0hs__compile_8h_1aeb302c749c316b296e3c3cdaa8508e73"><span>hs_compile()</span></a>, this value will be zero.</p>
</li>
<li><code class="first docutils literal"><span class="pre">from</span></code> - <p><ul class="simple">
<li>If a start of match flag is enabled for the current pattern, this argument will be set to the start of match for the pattern assuming that that start of match value lies within the current &#8216;start of match horizon&#8217; chosen by one of the SOM_HORIZON mode flags.</li>
<li>If the start of match value lies outside this horizon (possible only when the SOM_HORIZON value is not <a class="reference internal" href="#project0group__HS__MODE__FLAG_1gaae54cf9532a990b1ef7bdb4fa51eb3c6"><span>HS_MODE_SOM_HORIZON_LARGE</span></a>), the <em>from</em> value will be set to <a class="reference internal" href="#project0hs__runtime_8h_1a5a2035b99ba414e593a41b41a5f41a36"><span>HS_OFFSET_PAST_HORIZON</span></a>.</li>
<li>This argument will be set to zero if the Start of Match flag is not enabled for the given pattern.</li>
</ul>
</p>
</li>
<li><code class="first docutils literal"><span class="pre">to</span></code> - <p>The offset after the last byte that matches the expression.</p>
</li>
<li><code class="first docutils literal"><span class="pre">flags</span></code> - <p>This is provided for future use and is unused at present.</p>
</li>
<li><code class="first docutils literal"><span class="pre">context</span></code> - <p>The pointer supplied by the user to the <a class="reference internal" href="#project0hs__runtime_8h_1a261656043947931ad9d826d158119e89"><span>hs_scan()</span></a>, <a class="reference internal" href="#project0hs__runtime_8h_1ad6b603921a1fd2ddf12230730d6634c6"><span>hs_scan_vector()</span></a> or <a class="reference internal" href="#project0hs__runtime_8h_1a34d0eb9c280a58bbc29b19e22dead8b3"><span>hs_scan_stream()</span></a> function.</p>
</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef container">
<p class="breathe-sectiondef-title rubric">Functions</p>
<dl class="function">
<dt id="c.hs_open_stream">
<span class="target" id="project0hs__runtime_8h_1a54bc32490fdcc331d074e60169aeeda7"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t">hs_error_t</a> <code class="descname">hs_open_stream</code><span class="sig-paren">(</span>const  <a class="reference internal" href="#c.hs_database_t" title="hs_database_t">hs_database_t</a>  *<em>&nbsp;db</em>, unsigned int<em>&nbsp;flags</em>, <a class="reference internal" href="#c.hs_stream_t" title="hs_stream_t">hs_stream_t</a>  **<em>&nbsp;stream</em><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_open_stream" title="Permalink to this definition">¶</a></dt>
<dd><p>Open and initialise a stream.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd><a class="reference internal" href="#project0group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span>HS_SUCCESS</span></a> on success, other values on failure. </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last">
<li><code class="first docutils literal"><span class="pre">db</span></code> - <p>A compiled pattern database.</p>
</li>
<li><code class="first docutils literal"><span class="pre">flags</span></code> - <p>Flags modifying the behaviour of the stream. This parameter is provided for future use and is unused at present.</p>
</li>
<li><code class="first docutils literal"><span class="pre">stream</span></code> - <p>On success, a pointer to the generated <a class="reference internal" href="#project0hs__runtime_8h_1a2ef982d1aaecd7b08c091d355c44e7f3"><span>hs_stream_t</span></a> will be returned; NULL on failure.</p>
</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="c.hs_scan_stream">
<span class="target" id="project0hs__runtime_8h_1a34d0eb9c280a58bbc29b19e22dead8b3"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t">hs_error_t</a> <code class="descname">hs_scan_stream</code><span class="sig-paren">(</span><a class="reference internal" href="#c.hs_stream_t" title="hs_stream_t">hs_stream_t</a>  *<em>&nbsp;id</em>, const char *<em>&nbsp;data</em>, unsigned int<em>&nbsp;length</em>, unsigned int<em>&nbsp;flags</em>, <a class="reference internal" href="#c.hs_scratch_t" title="hs_scratch_t">hs_scratch_t</a>  *<em>&nbsp;scratch</em>, <a class="reference internal" href="#c.match_event_handler" title="match_event_handler">match_event_handler</a><em>&nbsp;onEvent</em>, void *<em>&nbsp;ctxt</em><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_scan_stream" title="Permalink to this definition">¶</a></dt>
<dd><p>Write data to be scanned to the opened stream.</p>
<p>This is the function call in which the actual pattern matching takes place as data is written to the stream. Matches will be returned via the <a class="reference internal" href="#project0hs__runtime_8h_1a8c0a6ab1493f9f5dacccfda985df4cd7"><span>match_event_handler</span></a> callback supplied.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>Returns <a class="reference internal" href="#project0group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span>HS_SUCCESS</span></a> on success; <a class="reference internal" href="#project0group__HS__ERROR_1ga122c9eb3b263d14360532e47c647fc16"><span>HS_SCAN_TERMINATED</span></a> if the match callback indicated that scanning should stop; other values on error. </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last">
<li><code class="first docutils literal"><span class="pre">id</span></code> - <p>The stream ID (returned by <a class="reference internal" href="#project0hs__runtime_8h_1a54bc32490fdcc331d074e60169aeeda7"><span>hs_open_stream()</span></a>) to which the data will be written.</p>
</li>
<li><code class="first docutils literal"><span class="pre">data</span></code> - <p>Pointer to the data to be scanned.</p>
</li>
<li><code class="first docutils literal"><span class="pre">length</span></code> - <p>The number of bytes to scan.</p>
</li>
<li><code class="first docutils literal"><span class="pre">flags</span></code> - <p>Flags modifying the behaviour of the stream. This parameter is provided for future use and is unused at present.</p>
</li>
<li><code class="first docutils literal"><span class="pre">scratch</span></code> - <p>A per-thread scratch space allocated by <a class="reference internal" href="#project0hs__runtime_8h_1ac0ddcd0c2a40f445211e415522fa7078"><span>hs_alloc_scratch()</span></a>.</p>
</li>
<li><code class="first docutils literal"><span class="pre">onEvent</span></code> - <p>Pointer to a match event callback function. If a NULL pointer is given, no matches will be returned.</p>
</li>
<li><code class="first docutils literal"><span class="pre">ctxt</span></code> - <p>The user defined pointer which will be passed to the callback function when a match occurs.</p>
</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="c.hs_close_stream">
<span class="target" id="project0hs__runtime_8h_1a2471dfb1596b87fb95ea19124fae0940"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t">hs_error_t</a> <code class="descname">hs_close_stream</code><span class="sig-paren">(</span><a class="reference internal" href="#c.hs_stream_t" title="hs_stream_t">hs_stream_t</a>  *<em>&nbsp;id</em>, <a class="reference internal" href="#c.hs_scratch_t" title="hs_scratch_t">hs_scratch_t</a>  *<em>&nbsp;scratch</em>, <a class="reference internal" href="#c.match_event_handler" title="match_event_handler">match_event_handler</a><em>&nbsp;onEvent</em>, void *<em>&nbsp;ctxt</em><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_close_stream" title="Permalink to this definition">¶</a></dt>
<dd><p>Close a stream.</p>
<p>This function must be called for any stream created with <a class="reference internal" href="#project0hs__runtime_8h_1a54bc32490fdcc331d074e60169aeeda7"><span>hs_open_stream()</span></a>, even if scanning has been terminated by a non-zero return from the match callback function.</p>
<p>Note: This operation may result in matches being returned (via calls to the match event callback) for expressions anchored to the end of the data stream (for example, via the use of the <code class="docutils literal"><span class="pre">$</span></code> meta-character). If these matches are not desired, NULL may be provided as the <a class="reference internal" href="#project0hs__runtime_8h_1a8c0a6ab1493f9f5dacccfda985df4cd7"><span>match_event_handler</span></a> callback.</p>
<p>If NULL is provided as the <a class="reference internal" href="#project0hs__runtime_8h_1a8c0a6ab1493f9f5dacccfda985df4cd7"><span>match_event_handler</span></a> callback, it is permissible to provide a NULL scratch.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>Returns <a class="reference internal" href="#project0group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span>HS_SUCCESS</span></a> on success, other values on failure. </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last">
<li><code class="first docutils literal"><span class="pre">id</span></code> - <p>The stream ID returned by <a class="reference internal" href="#project0hs__runtime_8h_1a54bc32490fdcc331d074e60169aeeda7"><span>hs_open_stream()</span></a>.</p>
</li>
<li><code class="first docutils literal"><span class="pre">scratch</span></code> - <p>A per-thread scratch space allocated by <a class="reference internal" href="#project0hs__runtime_8h_1ac0ddcd0c2a40f445211e415522fa7078"><span>hs_alloc_scratch()</span></a>. This is allowed to be NULL only if the <em>onEvent</em> callback is also NULL.</p>
</li>
<li><code class="first docutils literal"><span class="pre">onEvent</span></code> - <p>Pointer to a match event callback function. If a NULL pointer is given, no matches will be returned.</p>
</li>
<li><code class="first docutils literal"><span class="pre">ctxt</span></code> - <p>The user defined pointer which will be passed to the callback function when a match occurs.</p>
</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="c.hs_reset_stream">
<span class="target" id="project0hs__runtime_8h_1a6d7d40908655b373fe73f872a48cf853"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t">hs_error_t</a> <code class="descname">hs_reset_stream</code><span class="sig-paren">(</span><a class="reference internal" href="#c.hs_stream_t" title="hs_stream_t">hs_stream_t</a>  *<em>&nbsp;id</em>, unsigned int<em>&nbsp;flags</em>, <a class="reference internal" href="#c.hs_scratch_t" title="hs_scratch_t">hs_scratch_t</a>  *<em>&nbsp;scratch</em>, <a class="reference internal" href="#c.match_event_handler" title="match_event_handler">match_event_handler</a><em>&nbsp;onEvent</em>, void *<em>&nbsp;context</em><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_reset_stream" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset a stream to an initial state.</p>
<p>Conceptually, this is equivalent to performing <a class="reference internal" href="#project0hs__runtime_8h_1a2471dfb1596b87fb95ea19124fae0940"><span>hs_close_stream()</span></a> on the given stream, followed by a <a class="reference internal" href="#project0hs__runtime_8h_1a54bc32490fdcc331d074e60169aeeda7"><span>hs_open_stream()</span></a>. This new stream replaces the original stream in memory, avoiding the overhead of freeing the old stream and allocating the new one.</p>
<p>Note: This operation may result in matches being returned (via calls to the match event callback) for expressions anchored to the end of the original data stream (for example, via the use of the <code class="docutils literal"><span class="pre">$</span></code> meta-character). If these matches are not desired, NULL may be provided as the <a class="reference internal" href="#project0hs__runtime_8h_1a8c0a6ab1493f9f5dacccfda985df4cd7"><span>match_event_handler</span></a> callback.</p>
<p>Note: the stream will also be tied to the same database.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd><a class="reference internal" href="#project0group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span>HS_SUCCESS</span></a> on success, other values on failure. </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last">
<li><code class="first docutils literal"><span class="pre">id</span></code> - <p>The stream (as created by <a class="reference internal" href="#project0hs__runtime_8h_1a54bc32490fdcc331d074e60169aeeda7"><span>hs_open_stream()</span></a>) to be replaced.</p>
</li>
<li><code class="first docutils literal"><span class="pre">flags</span></code> - <p>Flags modifying the behaviour of the stream. This parameter is provided for future use and is unused at present.</p>
</li>
<li><code class="first docutils literal"><span class="pre">scratch</span></code> - <p>A per-thread scratch space allocated by <a class="reference internal" href="#project0hs__runtime_8h_1ac0ddcd0c2a40f445211e415522fa7078"><span>hs_alloc_scratch()</span></a>. This is allowed to be NULL only if the <em>onEvent</em> callback is also NULL.</p>
</li>
<li><code class="first docutils literal"><span class="pre">onEvent</span></code> - <p>Pointer to a match event callback function. If a NULL pointer is given, no matches will be returned.</p>
</li>
<li><code class="first docutils literal"><span class="pre">context</span></code> - <p>The user defined pointer which will be passed to the callback function when a match occurs.</p>
</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="c.hs_copy_stream">
<span class="target" id="project0hs__runtime_8h_1aac55833886321253c531331901f729b1"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t">hs_error_t</a> <code class="descname">hs_copy_stream</code><span class="sig-paren">(</span><a class="reference internal" href="#c.hs_stream_t" title="hs_stream_t">hs_stream_t</a>  **<em>&nbsp;to_id</em>, const  <a class="reference internal" href="#c.hs_stream_t" title="hs_stream_t">hs_stream_t</a>  *<em>&nbsp;from_id</em><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_copy_stream" title="Permalink to this definition">¶</a></dt>
<dd><p>Duplicate the given stream. The new stream will have the same state as the original including the current stream offset.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd><a class="reference internal" href="#project0group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span>HS_SUCCESS</span></a> on success, other values on failure. </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last">
<li><code class="first docutils literal"><span class="pre">to_id</span></code> - <p>On success, a pointer to the new, copied <a class="reference internal" href="#project0hs__runtime_8h_1a2ef982d1aaecd7b08c091d355c44e7f3"><span>hs_stream_t</span></a> will be returned; NULL on failure.</p>
</li>
<li><code class="first docutils literal"><span class="pre">from_id</span></code> - <p>The stream (as created by <a class="reference internal" href="#project0hs__runtime_8h_1a54bc32490fdcc331d074e60169aeeda7"><span>hs_open_stream()</span></a>) to be copied.</p>
</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="c.hs_reset_and_copy_stream">
<span class="target" id="project0hs__runtime_8h_1a35a1dc0df0262b4b5f7afe0ca5266831"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t">hs_error_t</a> <code class="descname">hs_reset_and_copy_stream</code><span class="sig-paren">(</span><a class="reference internal" href="#c.hs_stream_t" title="hs_stream_t">hs_stream_t</a>  *<em>&nbsp;to_id</em>, const  <a class="reference internal" href="#c.hs_stream_t" title="hs_stream_t">hs_stream_t</a>  *<em>&nbsp;from_id</em>, <a class="reference internal" href="#c.hs_scratch_t" title="hs_scratch_t">hs_scratch_t</a>  *<em>&nbsp;scratch</em>, <a class="reference internal" href="#c.match_event_handler" title="match_event_handler">match_event_handler</a><em>&nbsp;onEvent</em>, void *<em>&nbsp;context</em><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_reset_and_copy_stream" title="Permalink to this definition">¶</a></dt>
<dd><p>Duplicate the given &#8216;from&#8217; stream state onto the &#8216;to&#8217; stream. The &#8216;to&#8217; stream will first be reset (reporting any EOD matches if a non-NULL <em>onEvent</em> callback handler is provided).</p>
<p>Note: the &#8216;to&#8217; stream and the &#8216;from&#8217; stream must be open against the same database.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd><a class="reference internal" href="#project0group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span>HS_SUCCESS</span></a> on success, other values on failure. </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last">
<li><code class="first docutils literal"><span class="pre">to_id</span></code> - <p>On success, a pointer to the new, copied <a class="reference internal" href="#project0hs__runtime_8h_1a2ef982d1aaecd7b08c091d355c44e7f3"><span>hs_stream_t</span></a> will be returned; NULL on failure.</p>
</li>
<li><code class="first docutils literal"><span class="pre">from_id</span></code> - <p>The stream (as created by <a class="reference internal" href="#project0hs__runtime_8h_1a54bc32490fdcc331d074e60169aeeda7"><span>hs_open_stream()</span></a>) to be copied.</p>
</li>
<li><code class="first docutils literal"><span class="pre">scratch</span></code> - <p>A per-thread scratch space allocated by <a class="reference internal" href="#project0hs__runtime_8h_1ac0ddcd0c2a40f445211e415522fa7078"><span>hs_alloc_scratch()</span></a>. This is allowed to be NULL only if the <em>onEvent</em> callback is also NULL.</p>
</li>
<li><code class="first docutils literal"><span class="pre">onEvent</span></code> - <p>Pointer to a match event callback function. If a NULL pointer is given, no matches will be returned.</p>
</li>
<li><code class="first docutils literal"><span class="pre">context</span></code> - <p>The user defined pointer which will be passed to the callback function when a match occurs.</p>
</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="c.hs_scan">
<span class="target" id="project0hs__runtime_8h_1a261656043947931ad9d826d158119e89"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t">hs_error_t</a> <code class="descname">hs_scan</code><span class="sig-paren">(</span>const  <a class="reference internal" href="#c.hs_database_t" title="hs_database_t">hs_database_t</a>  *<em>&nbsp;db</em>, const char *<em>&nbsp;data</em>, unsigned int<em>&nbsp;length</em>, unsigned int<em>&nbsp;flags</em>, <a class="reference internal" href="#c.hs_scratch_t" title="hs_scratch_t">hs_scratch_t</a>  *<em>&nbsp;scratch</em>, <a class="reference internal" href="#c.match_event_handler" title="match_event_handler">match_event_handler</a><em>&nbsp;onEvent</em>, void *<em>&nbsp;context</em><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_scan" title="Permalink to this definition">¶</a></dt>
<dd><p>The block (non-streaming) regular expression scanner.</p>
<p>This is the function call in which the actual pattern matching takes place for block-mode pattern databases.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>Returns <a class="reference internal" href="#project0group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span>HS_SUCCESS</span></a> on success; <a class="reference internal" href="#project0group__HS__ERROR_1ga122c9eb3b263d14360532e47c647fc16"><span>HS_SCAN_TERMINATED</span></a> if the match callback indicated that scanning should stop; other values on error. </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last">
<li><code class="first docutils literal"><span class="pre">db</span></code> - <p>A compiled pattern database.</p>
</li>
<li><code class="first docutils literal"><span class="pre">data</span></code> - <p>Pointer to the data to be scanned.</p>
</li>
<li><code class="first docutils literal"><span class="pre">length</span></code> - <p>The number of bytes to scan.</p>
</li>
<li><code class="first docutils literal"><span class="pre">flags</span></code> - <p>Flags modifying the behaviour of this function. This parameter is provided for future use and is unused at present.</p>
</li>
<li><code class="first docutils literal"><span class="pre">scratch</span></code> - <p>A per-thread scratch space allocated by <a class="reference internal" href="#project0hs__runtime_8h_1ac0ddcd0c2a40f445211e415522fa7078"><span>hs_alloc_scratch()</span></a> for this database.</p>
</li>
<li><code class="first docutils literal"><span class="pre">onEvent</span></code> - <p>Pointer to a match event callback function. If a NULL pointer is given, no matches will be returned.</p>
</li>
<li><code class="first docutils literal"><span class="pre">context</span></code> - <p>The user defined pointer which will be passed to the callback function.</p>
</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="c.hs_scan_vector">
<span class="target" id="project0hs__runtime_8h_1ad6b603921a1fd2ddf12230730d6634c6"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t">hs_error_t</a> <code class="descname">hs_scan_vector</code><span class="sig-paren">(</span>const  <a class="reference internal" href="#c.hs_database_t" title="hs_database_t">hs_database_t</a>  *<em>&nbsp;db</em>, const char *const *<em>&nbsp;data</em>, const unsigned int *<em>&nbsp;length</em>, unsigned int<em>&nbsp;count</em>, unsigned int<em>&nbsp;flags</em>, <a class="reference internal" href="#c.hs_scratch_t" title="hs_scratch_t">hs_scratch_t</a>  *<em>&nbsp;scratch</em>, <a class="reference internal" href="#c.match_event_handler" title="match_event_handler">match_event_handler</a><em>&nbsp;onEvent</em>, void *<em>&nbsp;context</em><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_scan_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>The vectored regular expression scanner.</p>
<p>This is the function call in which the actual pattern matching takes place for vectoring-mode pattern databases.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>Returns <a class="reference internal" href="#project0group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span>HS_SUCCESS</span></a> on success; <a class="reference internal" href="#project0group__HS__ERROR_1ga122c9eb3b263d14360532e47c647fc16"><span>HS_SCAN_TERMINATED</span></a> if the match callback indicated that scanning should stop; other values on error. </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last">
<li><code class="first docutils literal"><span class="pre">db</span></code> - <p>A compiled pattern database.</p>
</li>
<li><code class="first docutils literal"><span class="pre">data</span></code> - <p>An array of pointers to the data blocks to be scanned.</p>
</li>
<li><code class="first docutils literal"><span class="pre">length</span></code> - <p>An array of lengths (in bytes) of each data block to scan.</p>
</li>
<li><code class="first docutils literal"><span class="pre">count</span></code> - <p>Number of data blocks to scan. This should correspond to the size of of the <em>data</em> and <em>length</em> arrays.</p>
</li>
<li><code class="first docutils literal"><span class="pre">flags</span></code> - <p>Flags modifying the behaviour of this function. This parameter is provided for future use and is unused at present.</p>
</li>
<li><code class="first docutils literal"><span class="pre">scratch</span></code> - <p>A per-thread scratch space allocated by <a class="reference internal" href="#project0hs__runtime_8h_1ac0ddcd0c2a40f445211e415522fa7078"><span>hs_alloc_scratch()</span></a> for this database.</p>
</li>
<li><code class="first docutils literal"><span class="pre">onEvent</span></code> - <p>Pointer to a match event callback function. If a NULL pointer is given, no matches will be returned.</p>
</li>
<li><code class="first docutils literal"><span class="pre">context</span></code> - <p>The user defined pointer which will be passed to the callback function.</p>
</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="c.hs_alloc_scratch">
<span class="target" id="project0hs__runtime_8h_1ac0ddcd0c2a40f445211e415522fa7078"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t">hs_error_t</a> <code class="descname">hs_alloc_scratch</code><span class="sig-paren">(</span>const  <a class="reference internal" href="#c.hs_database_t" title="hs_database_t">hs_database_t</a>  *<em>&nbsp;db</em>, <a class="reference internal" href="#c.hs_scratch_t" title="hs_scratch_t">hs_scratch_t</a>  **<em>&nbsp;scratch</em><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_alloc_scratch" title="Permalink to this definition">¶</a></dt>
<dd><p>Allocate a &#8220;scratch&#8221; space for use by Hyperscan.</p>
<p>This is required for runtime use, and one scratch space per thread, or concurrent caller, is required. Any allocator callback set by <a class="reference internal" href="#project0hs__common_8h_1a29e53465b9737c222bda3e7bcb324d61"><span>hs_set_scratch_allocator()</span></a> or <a class="reference internal" href="#project0hs__common_8h_1a5ca2c6de1dac5bb462e5cf4ab14de3bb"><span>hs_set_allocator()</span></a> will be used by this function.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd><a class="reference internal" href="#project0group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span>HS_SUCCESS</span></a> on successful allocation; <a class="reference internal" href="#project0group__HS__ERROR_1ga209e23f064df891f66575950b383832c"><span>HS_NOMEM</span></a> if the allocation fails. Other errors may be returned if invalid parameters are specified. </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last">
<li><code class="first docutils literal"><span class="pre">db</span></code> - <p>The database, as produced by <a class="reference internal" href="#project0hs__compile_8h_1aeb302c749c316b296e3c3cdaa8508e73"><span>hs_compile()</span></a>.</p>
</li>
<li><code class="first docutils literal"><span class="pre">scratch</span></code> - <p>On first allocation, a pointer to NULL should be provided so a new scratch can be allocated. If a scratch block has been previously allocated, then a pointer to it should be passed back in to see if it is valid for this database block. If a new scratch block is required, the original will be freed and the new one returned, otherwise the previous scratch block will be returned. On success, the scratch block will be suitable for use with the provided database in addition to any databases that original scratch space was suitable for.</p>
</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="c.hs_clone_scratch">
<span class="target" id="project0hs__runtime_8h_1a5ccab293a24ee56fcb82c715a7dca861"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t">hs_error_t</a> <code class="descname">hs_clone_scratch</code><span class="sig-paren">(</span>const  <a class="reference internal" href="#c.hs_scratch_t" title="hs_scratch_t">hs_scratch_t</a>  *<em>&nbsp;src</em>, <a class="reference internal" href="#c.hs_scratch_t" title="hs_scratch_t">hs_scratch_t</a>  **<em>&nbsp;dest</em><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_clone_scratch" title="Permalink to this definition">¶</a></dt>
<dd><p>Allocate a scratch space that is a clone of an existing scratch space.</p>
<p>This is useful when multiple concurrent threads will be using the same set of compiled databases, and another scratch space is required. Any allocator callback set by <a class="reference internal" href="#project0hs__common_8h_1a29e53465b9737c222bda3e7bcb324d61"><span>hs_set_scratch_allocator()</span></a> or <a class="reference internal" href="#project0hs__common_8h_1a5ca2c6de1dac5bb462e5cf4ab14de3bb"><span>hs_set_allocator()</span></a> will be used by this function.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd><a class="reference internal" href="#project0group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span>HS_SUCCESS</span></a> on success; <a class="reference internal" href="#project0group__HS__ERROR_1ga209e23f064df891f66575950b383832c"><span>HS_NOMEM</span></a> if the allocation fails. Other errors may be returned if invalid parameters are specified. </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last">
<li><code class="first docutils literal"><span class="pre">src</span></code> - <p>The existing <a class="reference internal" href="#project0hs__runtime_8h_1af0a89aeb8f5256f35c0bc86e8ca2a19b"><span>hs_scratch_t</span></a> to be cloned.</p>
</li>
<li><code class="first docutils literal"><span class="pre">dest</span></code> - <p>A pointer to the new scratch space will be returned here.</p>
</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="c.hs_scratch_size">
<span class="target" id="project0hs__runtime_8h_1a3d3b52dd640a76eaf2eb3280be452d78"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t">hs_error_t</a> <code class="descname">hs_scratch_size</code><span class="sig-paren">(</span>const  <a class="reference internal" href="#c.hs_scratch_t" title="hs_scratch_t">hs_scratch_t</a>  *<em>&nbsp;scratch</em>, size_t *<em>&nbsp;scratch_size</em><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_scratch_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Provides the size of the given scratch space.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd><a class="reference internal" href="#project0group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span>HS_SUCCESS</span></a> on success, other values on failure. </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last">
<li><code class="first docutils literal"><span class="pre">scratch</span></code> - <p>A per-thread scratch space allocated by <a class="reference internal" href="#project0hs__runtime_8h_1ac0ddcd0c2a40f445211e415522fa7078"><span>hs_alloc_scratch()</span></a> or <a class="reference internal" href="#project0hs__runtime_8h_1a5ccab293a24ee56fcb82c715a7dca861"><span>hs_clone_scratch()</span></a>.</p>
</li>
<li><code class="first docutils literal"><span class="pre">scratch_size</span></code> - <p>On success, the size of the scratch space in bytes is placed in this parameter.</p>
</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="c.hs_free_scratch">
<span class="target" id="project0hs__runtime_8h_1ac662a5057cf5520531775fc2841b8c5b"></span><a class="reference internal" href="#c.hs_error_t" title="hs_error_t">hs_error_t</a> <code class="descname">hs_free_scratch</code><span class="sig-paren">(</span><a class="reference internal" href="#c.hs_scratch_t" title="hs_scratch_t">hs_scratch_t</a>  *<em>&nbsp;scratch</em><span class="sig-paren">)</span><a class="headerlink" href="#c.hs_free_scratch" title="Permalink to this definition">¶</a></dt>
<dd><p>Free a scratch block previously allocated by <a class="reference internal" href="#project0hs__runtime_8h_1ac0ddcd0c2a40f445211e415522fa7078"><span>hs_alloc_scratch()</span></a> or <a class="reference internal" href="#project0hs__runtime_8h_1a5ccab293a24ee56fcb82c715a7dca861"><span>hs_clone_scratch()</span></a>.</p>
<p>The free callback set by <a class="reference internal" href="#project0hs__common_8h_1a29e53465b9737c222bda3e7bcb324d61"><span>hs_set_scratch_allocator()</span></a> or <a class="reference internal" href="#project0hs__common_8h_1a5ca2c6de1dac5bb462e5cf4ab14de3bb"><span>hs_set_allocator()</span></a> will be used by this function.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd><a class="reference internal" href="#project0group__HS__ERROR_1ga2d533509db8628a7e0eb794e2b3e77b0"><span>HS_SUCCESS</span></a> on success, other values on failure. </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last">
<li><code class="first docutils literal"><span class="pre">scratch</span></code> - <p>The scratch block to be freed. NULL may also be safely provided.</p>
</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="copyright.html">Copyright</a></li>
<li class="toctree-l1"><a class="reference internal" href="preface.html">Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="compilation.html">Compiling Patterns</a></li>
<li class="toctree-l1"><a class="reference internal" href="runtime.html">Scanning for Patterns</a></li>
<li class="toctree-l1"><a class="reference internal" href="performance.html">Performance Considerations</a></li>
<li class="toctree-l1"><a class="reference internal" href="api_constants.html">API Reference: Constants</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">API Reference: Files</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#file-hs-h">File: hs.h</a></li>
<li class="toctree-l2"><a class="reference internal" href="#file-hs-common-h">File: hs_common.h</a></li>
<li class="toctree-l2"><a class="reference internal" href="#file-hs-compile-h">File: hs_compile.h</a></li>
<li class="toctree-l2"><a class="reference internal" href="#file-hs-runtime-h">File: hs_runtime.h</a></li>
</ul>
</li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2015, Intel Corporation.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.3.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.6</a>
      
    </div>

    

    
  </body>
</html>